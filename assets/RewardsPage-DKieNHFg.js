import{c as N,j as e,C as v,B as R,G as w,J as G,r as i,I as O,K as U,u as B,n as D,H as M,L as P,F as T,N as E,l as _,o as $,h as q,d as V,z}from"./index-C0udEWay.js";import{B as b}from"./Button-BXzODrPk.js";import{A as Y}from"./award-BXFhFq9C.js";import{f as W}from"./formatDistanceToNow-Cc_IrjW0.js";import{H as J}from"./history-CRrD8Uu1.js";import{P as K}from"./ProductCardSkeleton-bwqg6bVQ.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]],X=N("clipboard-copy",Q);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ee=N("crown",Z);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],te=N("medal",se),re={bronze:{Icon:te,name:"Bronze Member",gradient:"from-orange-400 to-orange-600",nextTierName:"Silver",progressColor:"bg-gray-400",minPoints:0},silver:{Icon:Y,name:"Silver Member",gradient:"from-gray-300 to-gray-500",nextTierName:"Gold",progressColor:"bg-yellow-400",minPoints:300},gold:{Icon:ee,name:"Gold Member",gradient:"from-yellow-400 to-yellow-600",nextTierName:null,progressColor:"",minPoints:1e3}},ae=({tier:s,currentPoints:a,nextTierPoints:l,showProgress:c=!0})=>{const r=re[s],d=l-a,t=s!=="gold"?Math.max(0,Math.min(100,(a-r.minPoints)/(l-r.minPoints)*100)):100;return e.jsxs("div",{className:`relative w-full max-w-sm overflow-hidden rounded-2xl bg-gradient-to-br p-6 text-center text-white shadow-lg md:p-8 ${r.gradient}`,children:[e.jsx("div",{className:"absolute inset-0 -translate-x-full animate-shimmer bg-gradient-to-r from-transparent via-white/30 to-transparent"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(r.Icon,{className:"h-16 w-16 animate-pulse-slow drop-shadow-lg"}),e.jsx("h2",{className:"mt-4 font-display text-2xl font-bold drop-shadow-md md:text-3xl",children:r.name}),e.jsxs("p",{className:"font-semibold text-white/80",children:[a," points"]})]}),c&&s!=="gold"&&e.jsxs("div",{className:"relative z-10 mt-6 text-left",children:[e.jsxs("p",{className:"text-xs font-semibold md:text-sm",children:[e.jsx("span",{className:"font-bold",children:d>0?d:0})," points to ",r.nextTierName]}),e.jsx("div",{className:"mt-1 h-2.5 w-full overflow-hidden rounded-full bg-black/20",children:e.jsx("div",{className:`h-full rounded-full ${r.progressColor} transition-all duration-500 ease-out`,style:{width:`${t}%`}})})]})]})},oe={drink:"bg-blue-100 text-blue-800",food:"bg-green-100 text-green-800",discount:"bg-yellow-100 text-yellow-800"},ne=({reward:s,currentPoints:a,onRedeem:l})=>{const{id:c,name:r,description:d,pointsCost:t,imageUrl:m,category:o,available:x}=s,p=a>=t,h=x&&p,g=t-a,u=()=>x?p?"Redeem Now":e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4"}),"Need ",g," more points"]}):"Unavailable";return e.jsxs(v,{className:"flex flex-col overflow-hidden transition-transform duration-300 hover:-translate-y-1",hover:!0,children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:m,alt:r,className:`h-40 w-full object-cover ${x?"":"grayscale"}`}),e.jsx(R,{className:`absolute top-2 left-2 capitalize ${oe[o]}`,children:o}),!x&&e.jsx(R,{className:"absolute top-2 right-2 bg-gray-500 text-white",children:"Temporarily Unavailable"})]}),e.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-lg font-semibold text-coffee-900",children:r}),e.jsx("p",{className:"mt-1 h-10 text-sm text-gray-600 line-clamp-2",children:d})]}),e.jsx("div",{className:"mt-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 text-primary-600",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsxs("p",{className:"text-lg font-bold",children:[t," points"]})]})}),e.jsx("button",{onClick:()=>l(c),disabled:!h,className:"mt-4 flex w-full items-center justify-center gap-2 rounded-full bg-primary-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:bg-gray-400 disabled:text-gray-100","aria-label":h?`Redeem ${r}`:`Cannot redeem ${r}`,children:u()})]})]})},ie=({history:s})=>{const[a,l]=i.useState("all"),c=i.useMemo(()=>a==="all"?s:s.filter(t=>t.type===a),[s,a]),r=i.useMemo(()=>[...c].sort((t,m)=>m.date.getTime()-t.date.getTime()),[c]),d=t=>t==="earned"?e.jsx("div",{className:"absolute left-1 top-0 flex h-10 w-10 -translate-x-1/2 items-center justify-center rounded-full bg-gradient-to-br from-green-400 to-green-600 shadow-lg ring-2 ring-white transition-transform hover:scale-110",children:e.jsx(O,{className:"h-4 w-4 text-white",strokeWidth:3})}):e.jsx("div",{className:"absolute left-1 top-0 flex h-10 w-10 -translate-x-1/2 items-center justify-center rounded-full bg-gradient-to-br from-red-400 to-red-600 shadow-lg ring-2 ring-white transition-transform hover:scale-110",children:e.jsx(U,{className:"h-4 w-4 text-white",strokeWidth:3})});return e.jsxs(v,{className:"bg-gradient-to-br from-white to-gray-50",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-3xl font-bold text-coffee-900",children:"Points History"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Track your rewards journey"})]}),e.jsx("div",{className:"flex gap-2 rounded-full bg-white p-1.5 shadow-sm ring-1 ring-gray-200",children:["all","earned","redeemed"].map(t=>e.jsx("button",{onClick:()=>l(t),className:`rounded-full px-4 py-2 text-sm font-semibold capitalize transition-all duration-200 ${a===t?"bg-gradient-to-r from-primary-600 to-primary-700 text-white shadow-md":"text-gray-700 hover:bg-gray-100"}`,children:t},t))})]}),e.jsx("div",{className:"mt-8 max-h-[500px] overflow-y-auto pr-2 scrollbar-thin scrollbar-track-gray-100 scrollbar-thumb-gray-300",children:r.length>0?e.jsx("div",{className:"relative border-l-2 border-gray-300 pl-6",children:r.map((t,m)=>e.jsxs("div",{className:`group relative transition-all duration-200 hover:translate-x-1 ${m<r.length-1?"pb-10":""}`,children:[d(t.type),e.jsxs("div",{className:"ml-8 flex items-start justify-between gap-4 rounded-lg bg-white p-4 shadow-sm ring-1 ring-gray-100 transition-shadow duration-200 group-hover:shadow-md",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate font-semibold text-gray-900",children:t.description}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:W(t.date,{addSuffix:!0})})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("p",{className:`text-xl font-bold ${t.type==="earned"?"text-green-600":"text-red-600"}`,children:[t.type==="earned"?"+":"",t.points]})})]})]},t.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-lg bg-gray-50 py-16 text-center",children:[e.jsx("div",{className:"rounded-full bg-gray-100 p-4",children:e.jsx(J,{className:"h-12 w-12 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"No transactions yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Your points history for this filter will appear here."})]})]})})]})},le={bronze:{min:0,max:299,name:"Bronze"},silver:{min:300,max:999,name:"Silver"},gold:{min:1e3,max:1/0,name:"Gold"}},y=s=>`/RushCoffee-Capstone/${s}`,de=[{name:"Free Grande Drink",description:"Redeem your points for any Grande-sized drink on our menu. A perfect treat!",pointsCost:200,imageUrl:y("Rewards/Free-Iced-Grande-Drink.jpg"),category:"drink",available:!0,displayOrder:1},{name:"10% Off Total Order",description:"Get a 10% discount on your entire order. Great for when you're treating friends!",pointsCost:200,imageUrl:y("Rewards/10-percent-off.jpg"),category:"discount",available:!0,displayOrder:2},{name:"Free Rice Meal",description:"Choose any Tasty Rice Meal from our selection to complement your coffee.",pointsCost:350,imageUrl:y("Rewards/Free-Rice-Meal.jpg"),category:"food",available:!0,displayOrder:3},{name:"Upgrade to Venti",description:"Get a free size upgrade from Grande to Venti on any drink.",pointsCost:300,imageUrl:y("Rewards/Free-Iced-Venti-Drink.jpg"),category:"drink",available:!0,displayOrder:4}],fe=()=>{var k;const{currentUser:s}=B(),{showToast:a}=D(),[l,c]=i.useState([]),[r,d]=i.useState(!0),[t,m]=i.useState(!1),[o,x]=i.useState(null),[p,h]=i.useState(!1),[g,u]=i.useState("");i.useEffect(()=>{(async()=>{d(!0);const f=de.map((I,A)=>({...I,id:`mock-reward-${A}`}));c(f),d(!1)})()},[]);const C=(s==null?void 0:s.tier)==="bronze"?"silver":(s==null?void 0:s.tier)==="silver"?"gold":null,S=C&&((k=le[C])==null?void 0:k.min)||0,F=n=>{x(n),m(!0)},L=async()=>{if(!(!s||!o)){h(!0);try{if(s.currentPoints<o.pointsCost)throw new Error("You don't have enough points.");const n=V.collection("users").doc(s.uid),f={id:`rh-${Date.now()}`,type:"redeemed",points:-o.pointsCost,description:`Redeemed: ${o.name}`,date:new Date};await n.update({currentPoints:z.firestore.FieldValue.increment(-o.pointsCost),rewardsHistory:z.firestore.FieldValue.arrayUnion(f)}),u(`RC-REDEEM-${Math.random().toString(36).substr(2,9).toUpperCase()}`)}catch(n){a(n.message||"Failed to redeem reward."),h(!1)}}},H=()=>{navigator.clipboard&&(navigator.clipboard.writeText(g),a("Code copied to clipboard!"))},j=()=>{m(!1),x(null),h(!1),u("")};return s?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(M,{}),e.jsxs("main",{children:[e.jsx("section",{className:"bg-gradient-to-r from-primary-50 to-coffee-50 px-6 py-12",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsxs("div",{className:"grid grid-cols-1 items-center gap-8 md:grid-cols-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h1",{className:"font-display text-4xl font-bold text-coffee-900 md:text-5xl",children:["Welcome, ",s.firstName,"!"]}),e.jsx("p",{className:"mt-2 text-lg text-gray-600",children:"You're doing great! Keep earning points for amazing rewards."})]}),e.jsx("div",{className:"flex justify-center md:justify-end",children:e.jsx(ae,{tier:s.tier,currentPoints:s.currentPoints,nextTierPoints:S})})]})})}),e.jsx("section",{className:"px-6 py-16",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"mb-8 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-3xl font-bold text-coffee-900",children:"Redeem Your Points"}),e.jsx("p",{className:"mt-1 text-gray-600",children:"Use your points to claim these exciting rewards."})]}),e.jsxs("div",{className:"rounded-full bg-white px-4 py-2 text-lg font-semibold text-primary-600 shadow-md",children:["Your Points: ",e.jsx("span",{className:"font-bold",children:s.currentPoints})]})]}),r?e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Array.from({length:4}).map((n,f)=>e.jsx(K,{},f))}):l.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:l.map(n=>e.jsx(ne,{reward:n,currentPoints:s.currentPoints,onRedeem:()=>F(n)},n.id))}):e.jsxs(v,{className:"py-20 text-center",children:[e.jsx(w,{className:"mx-auto h-16 w-16 text-gray-300"}),e.jsx("h3",{className:"mt-4 font-semibold text-gray-800",children:"No Rewards Available"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Please check back later for new rewards."})]})]})}),e.jsx("section",{className:"bg-white px-6 py-16",children:e.jsx("div",{className:"container mx-auto max-w-4xl",children:e.jsx(ie,{history:s.rewardsHistory})})})]}),e.jsx(T,{}),e.jsx(E,{isOpen:t,onClose:j,title:g?"Reward Claimed!":`Redeem: ${(o==null?void 0:o.name)||""}`,children:g?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:e.jsx($,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"Success!"}),e.jsx("p",{className:"mt-1 text-gray-600",children:"Show this code at the counter to claim your reward:"}),e.jsxs("div",{className:"relative my-4 rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4",children:[e.jsx("p",{className:"font-mono text-2xl font-bold text-primary-700 tracking-widest",children:g}),e.jsx("button",{onClick:H,className:"absolute top-2 right-2 text-gray-400 hover:text-primary-600",children:e.jsx(X,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 rounded-lg bg-yellow-50 p-3 text-sm text-yellow-800",children:[e.jsx(q,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{children:"This code is for one-time use only."})]}),e.jsx("div",{className:"mt-6",children:e.jsx(b,{onClick:j,children:"Close"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-center text-gray-600",children:["Are you sure you want to spend ",e.jsxs("span",{className:"font-bold text-primary-600",children:[o==null?void 0:o.pointsCost," points"]})," to redeem this reward?"]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(b,{variant:"ghost",onClick:j,children:"Cancel"}),e.jsxs(b,{onClick:L,disabled:p,children:[p?e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx($,{className:"mr-2 h-4 w-4"}),"Confirm"]})]})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50",children:[e.jsx(M,{}),e.jsx("main",{className:"flex flex-1 items-center justify-center px-6 py-20 text-center",children:e.jsxs("div",{children:[e.jsx(w,{className:"mx-auto h-24 w-24 text-gray-300 opacity-50"}),e.jsx("h1",{className:"mt-4 font-display text-2xl font-bold text-coffee-900",children:"Join Our Rewards Program"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Log in or create an account to start earning points and get free coffee!"}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[e.jsx(P,{to:"/auth/login",className:"rounded-full bg-primary-600 px-8 py-3 font-semibold text-white transition-transform hover:scale-105",children:"Login"}),e.jsx(P,{to:"/auth/register",className:"rounded-full border-2 border-primary-600 px-8 py-3 font-semibold text-primary-600 transition-transform hover:scale-105 hover:bg-primary-50",children:"Sign Up"})]})]})}),e.jsx(T,{})]})};export{fe as default};
