import{c as ae,r as i,f as Z,o as _,n as X,z as F,j as e,D as A,p as x,E as re,v as ie,d as Y,y as U,u as oe,s as ne,m as le,I as ce,J as de,H as G,R as me,L as P,F as V,X as xe,A as ue,K as fe,P as he}from"./index-CeTvPb5i.js";import{B as p}from"./Button-7EiVU78F.js";import{D as $}from"./DigitalReceipt-CdT99Zd7.js";import{B as R}from"./bell-2tB5X9ux.js";import{C}from"./coffee-BfFzb84j.js";import{C as L}from"./clock-DRheYq4O.js";import{S as ge}from"./star-BuyZ9k-S.js";import{T as pe}from"./thumbs-up-D_2d3uTi.js";import{S as ye}from"./shopping-bag-Df_4vLZe.js";import{A as Ne}from"./award-BxFki7ls.js";import{T as be}from"./trending-up-2jcTlzGr.js";import{S as je}from"./sparkles-DkTpaRkK.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],q=ae("receipt",we),ve=({delay:t})=>{const r=Math.random()*300-150,n=Math.random()*300+50,f=Math.random()*360,y=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"],N=y[Math.floor(Math.random()*y.length)];return e.jsx(x.div,{initial:{opacity:1,x:0,y:-20,scale:.5,rotate:0},animate:{opacity:[1,1,0],x:r,y:n,scale:[.5,1,.5],rotate:f},transition:{duration:2.5,delay:t,ease:"easeOut"},style:{position:"absolute",top:0,left:"50%",width:"8px",height:"8px",backgroundColor:N,borderRadius:Math.random()>.5?"50%":"2px",zIndex:50}})},Me=()=>{const t=Array.from({length:60});return e.jsx("div",{className:"absolute top-0 left-0 right-0 h-full pointer-events-none overflow-hidden z-50",children:t.map((r,n)=>e.jsx(ve,{delay:Math.random()*.3},n))})},H={waiting:{Icon:L,text:"Order Placed",subtext:"We've received your order.",color:"text-amber-600",bgColor:"bg-amber-50",headerGradient:"from-amber-500 to-amber-600",step:1},preparing:{Icon:C,text:"Brewing Now",subtext:"Your coffee is being crafted.",color:"text-blue-600",bgColor:"bg-blue-50",headerGradient:"from-blue-500 to-blue-600",step:2},ready:{Icon:R,text:"Ready for Pickup!",subtext:"Grab it at the counter.",color:"text-green-600",bgColor:"bg-green-50",headerGradient:"from-green-500 to-green-600",step:3},completed:{Icon:_,text:"Enjoy!",subtext:"Order completed.",color:"text-primary-600",bgColor:"bg-primary-50",headerGradient:"from-primary-600 to-primary-800",step:4}},Ie=({order:t,onDismiss:r})=>{const[n,f]=i.useState(!1),[y,N]=i.useState(!1),[w,k]=i.useState(!1),[S,v]=i.useState(0),[z,T]=i.useState(0),[b,h]=i.useState(!1),u=Z(),m=H[t.status]||H.waiting,{showToast:M}=X();i.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),i.useEffect(()=>{const a=sessionStorage.getItem(`confetti_shown_${t.id}`);if(t.status==="ready"&&!a){N(!0),sessionStorage.setItem(`confetti_shown_${t.id}`,"true");const l=setTimeout(()=>N(!1),4e3);return()=>clearTimeout(l)}},[t.status,t.id]);const I=()=>{u("/menu")},g=async()=>{if(!w){k(!0);try{let a=0;const l=[];if(t.orderItems.forEach(o=>{l.push(o.productName);const c=o.productName.toLowerCase();c.includes("grande")?a+=4*o.quantity:c.includes("venti")?a+=5*o.quantity:c.includes("ala carte")?a+=4*o.quantity:c.includes("combo")&&(a+=5*o.quantity)}),await Y.collection("orders").doc(t.id).update({status:"completed",completedAt:new Date,updatedAt:new Date}),t.userId){const o={totalOrders:U.firestore.FieldValue.increment(1)};if(a>0){o.currentPoints=U.firestore.FieldValue.increment(a),o.loyaltyPoints=U.firestore.FieldValue.increment(a);const c={id:`rh-${Date.now()}`,type:"earned",points:a,description:`Earned from ${l.join(", ")}`,date:new Date};o.rewardsHistory=U.firestore.FieldValue.arrayUnion(c)}await Y.collection("users").doc(t.userId).update(o),a>0?M(`Order completed! Earned ${a} loyalty points!`):M("Order marked as completed!")}}catch(a){console.error("Error updating order status:",a),M("Failed to update order status. Please try again.")}finally{k(!1)}}};return t.status==="completed"?F.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs(x.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-sm overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:`bg-gradient-to-br ${m.headerGradient} px-6 py-8 text-center text-white relative overflow-hidden`,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsx(x.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20,delay:.1},className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10",children:e.jsx(_,{className:"h-8 w-8 text-white",strokeWidth:3})}),e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:"Enjoy your coffee!"}),e.jsxs("p",{className:"mt-1 text-primary-100 font-medium",children:["Order #",t.orderNumber," completed"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("p",{className:"mb-3 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:"How was your experience?"}),e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(a=>e.jsx(x.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>v(a),onMouseEnter:()=>T(a),onMouseLeave:()=>T(0),className:"focus:outline-none",children:e.jsx(ge,{className:`h-8 w-8 transition-colors duration-200 ${a<=(z||S)?"fill-amber-400 text-amber-400":"fill-gray-100 text-gray-300"}`})},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{size:"lg",variant:"outline",className:"w-full rounded-xl border-2 border-gray-100 text-gray-700 hover:bg-gray-50 hover:border-gray-200 font-semibold py-3.5",onClick:()=>h(!0),children:[e.jsx(q,{className:"mr-2 h-5 w-5"}),"View Receipt"]}),r&&e.jsx(p,{size:"lg",className:"w-full rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-lg hover:shadow-primary-600/30 transition-all font-bold py-3.5 text-base",onClick:()=>{u("/queue"),r&&r()},children:"Done"}),e.jsx(p,{size:"lg",variant:"ghost",className:"w-full rounded-xl text-primary-600 hover:bg-primary-50 font-semibold py-2",onClick:()=>u("/menu"),children:"Order Again"})]})]})]})]},"completed-modal")}),e.jsx($,{order:t,isOpen:b,onClose:()=>h(!1)})]}),document.body):F.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[y&&e.jsx(Me,{}),e.jsxs(x.div,{className:`relative overflow-hidden px-6 py-8 text-center text-white bg-gradient-to-br ${m.headerGradient}`,layout:!0,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(A,{mode:"wait",children:e.jsx(x.div,{initial:{scale:.8,opacity:0,rotate:-20},animate:{scale:1,opacity:1,rotate:0},exit:{scale:.8,opacity:0,rotate:20},transition:{type:"spring",stiffness:200,damping:15},className:"mb-3 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10 shadow-lg",children:e.jsx(m.Icon,{className:"h-8 w-8 text-white"})},t.status)}),e.jsx(A,{mode:"wait",children:e.jsxs(x.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.3},children:[e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:m.text}),e.jsx("p",{className:"mt-1 text-white/90 font-medium text-base",children:m.subtext})]},`${t.status}-text`)}),e.jsxs("div",{className:"mt-3 inline-flex items-center rounded-full bg-white/20 px-3 py-1 text-xs font-medium text-white backdrop-blur-md border border-white/10",children:["Order #",t.orderNumber]})]})]}),e.jsx("div",{className:"px-6 py-5 bg-white",children:e.jsxs("div",{className:"relative flex justify-between items-center",children:[e.jsx("div",{className:"absolute left-[20px] right-[20px] top-[16px] h-1 -translate-y-1/2 bg-gray-100 rounded-full z-0"}),e.jsx(x.div,{className:`absolute left-[20px] top-[16px] h-1 -translate-y-1/2 rounded-full z-0 bg-gradient-to-r ${m.headerGradient}`,initial:{width:"0%"},animate:{width:m.step===1?"0%":m.step===2?"50%":"calc(100% - 40px)"},transition:{duration:.5,ease:"easeInOut"}}),["waiting","preparing","ready"].map((a,l)=>{const o=l+1,c=m.step>=o,E=m.step===o;let D=L;return a==="preparing"&&(D=C),a==="ready"&&(D=R),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(x.div,{animate:{scale:E?1.2:1,backgroundColor:"#fff",borderColor:c?"currentColor":"#E5E7EB",boxShadow:E?"0 10px 15px -3px rgba(0, 0, 0, 0.1)":"none"},transition:{duration:.3},className:`flex h-8 w-8 items-center justify-center rounded-full border-2 transition-colors duration-300 ${c?m.color.replace("text-","border-"):"border-gray-200 text-gray-300"}`,children:e.jsx(D,{className:`h-4 w-4 ${c?m.color:"text-gray-300"}`})}),e.jsx("span",{className:`mt-2 text-[10px] font-bold uppercase tracking-wider transition-colors duration-300 ${c?m.color:"text-gray-400"}`,children:a})]},a)})]})}),e.jsxs("div",{className:"border-t border-gray-100 bg-gray-50/50 px-6 py-5",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Estimated Wait"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-0.5",children:["~",t.estimatedTime," min"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Total Amount"}),e.jsxs("p",{className:"text-lg font-bold text-primary-600 mt-0.5",children:["â‚±",t.totalAmount.toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f(!n),className:"flex w-full items-center justify-between rounded-xl bg-white px-4 py-3 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-gray-100 transition-all hover:bg-gray-50 hover:shadow-md",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-semibold",children:["View Order Items (",t.orderItems.length,")"]})]}),e.jsx(re,{className:`h-4 w-4 text-gray-400 transition-transform duration-300 ${n?"rotate-180":""}`})]}),e.jsx(A,{children:n&&e.jsxs(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden rounded-xl bg-white shadow-sm ring-1 ring-gray-100",children:[e.jsx("ul",{className:"divide-y divide-gray-50 px-5",children:t.orderItems.map((a,l)=>e.jsxs("li",{className:"flex justify-between py-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-gray-900 block",children:a.productName}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["Qty: ",a.quantity]})]}),e.jsxs("span",{className:"font-bold text-gray-600",children:["â‚±",(a.price*a.quantity).toFixed(2)]})]},l))}),e.jsx("div",{className:"p-3 border-t border-gray-50 bg-gray-50/50",children:e.jsxs(p,{size:"sm",variant:"ghost",className:"w-full text-xs font-semibold text-primary-600 hover:bg-primary-50",onClick:()=>h(!0),children:[e.jsx(q,{className:"mr-2 h-3 w-3"}),"View Digital Receipt"]})})]})}),e.jsxs("div",{className:"pt-1 space-y-2",children:[t.status==="ready"?e.jsx(p,{variant:"primary",className:"w-full rounded-xl bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-green-600/30 transition-all py-3.5 text-base font-bold",onClick:g,disabled:w,children:w?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Updating..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"I've Received My Order"]})}):e.jsxs(p,{variant:"primary",className:"w-full rounded-xl bg-coffee-600 text-white hover:bg-coffee-700 shadow-lg hover:shadow-coffee-600/30 transition-all py-3.5 font-bold",onClick:I,children:[e.jsx(ye,{className:"mr-2 h-5 w-5"}),"Browse Menu"]}),e.jsxs(p,{variant:"ghost",className:"w-full rounded-xl text-gray-500 hover:bg-gray-100 font-semibold py-2.5",onClick:()=>u("/menu"),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Back to Menu"]})]})]})]})]})]},"active-modal")}),e.jsx($,{order:t,isOpen:b,onClose:()=>h(!1)})]}),document.body)},De="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQ2IiBoZWlnaHQ9IjE3OCIgdmlld0JveD0iMCAwIDI0NiAxNzgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xNTQuNTAzIDgwQzE4MC41MDMgNTEgMjEzLjAwMyAyMC41IDIyNS41MDMgMTguNUMyMzguMDAzIDE2LjUgMjQ0LjAwMyAyOS41IDI0NC4wMDMgMjkuNUMyNDQuMDAzIDI5LjUgMjQ4LjUwMyA1Mi41IDI0MC41MDMgODBDMjMyLjUwMyAxMDcuNSAyMTEuNTAzIDEyNCAyMTEuNTAzIDEyNEMyMTEuNTAzIDEyNCAxNjYuNTAzIDE3MSAxNDcuMDAzIDE3NUMxNDcuMDAzIDE3NSAxMTkuMDAzIDE4MS41IDEwNy4wMDMgMTcyLjVDOTUuMDAyNSAxNjMuNSAxMjguNTAzIDEwOSAxNTQuNTAzIDgwWiIgZmlsbD0iI0VCNUYxNiIvPgo8cGF0aCBkPSJNMTIuMDAyNSA4OUMxMi4wMDI1IDg5IC0yMS4wMjkzIDIyLjAyMyAyMi41MDI1IDE3QzM1LjUwMjUgMTUuNSA4MC4wMDI1IDU2IDc5LjUwMjUgNTkuNUM4Mi41MDI1IDc1IDcyLjAwMjUgODcgNjQuNTAyNSA5N0M2MS4xMzM2IDEwMS40OTIgNjAuMDAyNSAxMDcuNSA1OC4wMDI1IDExOS41QzU4LjAwMjUgMTM5IDUzLjAwMjUgMTM4LjUgNTMuMDAyNSAxMzguNUM1My4wMDI1IDEzOC41IDQwLjUwMjUgMTQxIDEyLjAwMjUgODlaIiBmaWxsPSIjRUI1RjE2IiIvPgo8cGF0aCBkPSJNNDcuMDAyNSAxN0M0MS4wMDI1IDEyLjAwMDEgNDIuMDAyNSAtNy42MjkzOWUtMDYgNTMuMDAyNSAwQzY0LjAwMjUgNy42Mjk0ZS0wNiA3NC4xOTA0IDQuNzY1MzQgODcuMDAyNSAxMEMxMDAuMzQ3IDE1LjQ1MjEgMTEwLjkxMSAxOSAxMTQuNTAzIDI2LjVDMTE4LjA5NCAzNCAxMTQuNTAzIDM5LjUgMTEwLjAwMyA0NUMxMDUuNTAzIDUwLjUgMTAyLjAwMyA1MiA5NC41MDI1IDUxQzg3LjAwMjUgNTAgNTMuMDAyNSAyMiA0Ny4wMDI1IDE3WiIgZmlsbD0iI0VCNUYxNiIvPgo8cGF0aCBkPSJNMjA1LjUwMyAyMy41QzIxOC41MDMgMTQgMjA1LjUwMyA1LjUgMjA1LjUwMyA1LjVDMTYyLjIzOSAxLjQzMjUyIDEyMi40MDggMzEuOTMyNCA4Mi4wMDI1IDg4LjVDNzEuNjQ1NCAxMDMgNjIuNTU4MyAxNTAuMzIyIDc4LjUwMjUgMTYxQzk3LjE3ODQgMTczLjUwOCAxMDIuNjM0IDE2Ny4xMDkgMTAzLjUwMyAxMzJDMTIxLjUwMyA1MSAxOTIuNTAzIDMzIDIwNS41MDMgMjMuNVoiIGZpbGw9IiNFQjVGMTYiLz4KPC9zdmc+Cg==";let J=null;const Ae=async()=>{if(console.log("[Notifications] ðŸ” Checking notification support..."),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported in this browser"),"denied";console.log("[Notifications] âœ… Notification API available"),console.log("[Notifications] Current permission:",Notification.permission);try{console.log("[Notifications] ðŸ“ Requesting notification permission...");const t=await Notification.requestPermission();return console.log("[Notifications] Permission result:",t),t}catch(t){return console.error("[Notifications] âŒ Error requesting notification permission:",t),"denied"}},Ce=async t=>{if(console.log("[Notifications] ðŸ”” Attempting to show notification:",t.title),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported"),!1;if(console.log("[Notifications] Current permission:",Notification.permission),Notification.permission!=="granted")return console.warn("[Notifications] âŒ Notification permission not granted. Current:",Notification.permission),!1;const r={body:t.body,icon:t.icon,tag:t.tag,badge:t.icon,vibrate:[200,100,200],requireInteraction:!1,data:t.data};console.log("[Notifications] Notification options:",r);try{if(J&&"showNotification"in J,"Notification"in window&&typeof Notification=="function"){console.log("[Notifications] ðŸ’» Using direct Notification API (fallback)");const n=new Notification(t.title,r);return n.onclick=()=>{console.log("[Notifications] ðŸ‘† Notification clicked"),window.focus(),n.close()},console.log("[Notifications] âœ… Direct notification shown successfully!"),!0}return console.warn("[Notifications] âŒ No notification method available"),!1}catch(n){return console.error("[Notifications] âŒ Error showing notification:",n),!1}},ke=()=>{if(!("Notification"in window))return"denied";const t=Notification.permission;return console.log("[Notifications] Current permission status:",t),t},W=()=>{const t="Notification"in window;return console.log("[Notifications] Notifications supported:",t),t},Q=()=>e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-md border border-gray-100 text-center animate-pulse",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 mb-3"}),e.jsx("div",{className:"h-8 w-16 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"})]})}),Ye=()=>{var B;const{currentUser:t}=oe(),{activeOrder:r,orderHistory:n}=ne(),{products:f,isLoading:y}=le(),{addToCart:N,showToast:w}=X(),k=ce(),S=Z(),[v,z]=i.useState("default"),[T,b]=i.useState(!1),h=i.useRef(null),[u,m]=i.useState(null),[M,I]=i.useState(!1),[g,a]=i.useState(()=>{const s=localStorage.getItem("dismissedOrderIds");return s?JSON.parse(s):[]});i.useEffect(()=>{localStorage.setItem("dismissedOrderIds",JSON.stringify(g))},[g]);const l=i.useMemo(()=>{const s=n.find(d=>d.status==="completed"&&!g.includes(d.id));return s||r||null},[r,n,g]),o=i.useMemo(()=>{const s=f.length>0?f:de;return s.length>0?s[0]:null},[f]),[c,E]=i.useState(((B=k.state)==null?void 0:B.fromCheckout)||!1);i.useEffect(()=>{if(c){const s=setTimeout(()=>{E(!1),window.history.replaceState({},document.title)},2e3);return()=>clearTimeout(s)}},[c]),i.useEffect(()=>{if(W()){const s=ke();z(s),s==="default"&&b(!0)}},[]),i.useEffect(()=>{r&&r.status==="ready"&&v==="granted"&&h.current!==r.id&&Ce({title:"Your Order is Ready! â˜•",body:`Your Rush Coffee order (${r.orderNumber}) is now ready for pickup.`,icon:De,tag:r.id,data:{orderId:r.id,orderNumber:r.orderNumber}}).then(s=>{s&&(console.log("Notification sent successfully"),h.current=r.id)}),(!r||r.status==="completed")&&(h.current=null)},[r,v]);const D=async()=>{if(!W()){alert("This browser does not support notifications");return}const s=await Ae();z(s),(s==="granted"||s==="denied")&&b(!1)},K=()=>{if(l){const s=[...g,l.id];a(s),localStorage.setItem("dismissedOrderIds",JSON.stringify(s))}},ee=s=>{m(s),I(!0)},te=(s,d)=>{if(u){const j=u.sizes[0];N(u,j,s,d),w(`Added ${d} ${u.name} to cart`),I(!1)}},O=i.useMemo(()=>n.filter(s=>s.status==="completed").slice(0,2),[n]),se=s=>{const d=f.find(j=>j.id===s);return(d==null?void 0:d.imageUrl)||null};return t?e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50 relative",children:[e.jsx(G,{}),e.jsxs("section",{className:"relative overflow-hidden bg-gradient-to-br from-coffee-900 via-coffee-800 to-primary-900 px-6 py-12 text-white shadow-xl sm:py-20",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),e.jsx("div",{className:"absolute -right-20 -top-20 h-96 w-96 rounded-full bg-primary-500 blur-3xl opacity-20"}),e.jsx("div",{className:"absolute -left-20 -bottom-20 h-72 w-72 rounded-full bg-coffee-500 blur-3xl opacity-20"}),e.jsxs("div",{className:"container relative mx-auto max-w-3xl text-center",children:[e.jsxs("div",{className:"inline-flex items-center rounded-full bg-white/10 px-4 py-1.5 text-sm font-medium text-primary-100 backdrop-blur-sm ring-1 ring-white/20 mb-6",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Live Order Tracking"]}),e.jsx("h1",{className:"font-display text-4xl font-bold leading-tight tracking-tight md:text-5xl text-white mb-4",children:"Your Queue"}),e.jsx("p",{className:"text-lg text-coffee-100 max-w-xl mx-auto",children:"Track your orders in real-time and see your coffee journey stats."})]})]}),e.jsxs("main",{className:"flex-1 w-full max-w-3xl mx-auto px-4 py-8 sm:py-12 relative z-10 -mt-10",children:[l&&e.jsx(Ie,{order:l,onDismiss:K}),c&&!l&&e.jsx("div",{className:"fixed top-24 left-1/2 -translate-x-1/2 z-50 w-full max-w-md px-4",children:e.jsxs("div",{className:"w-full rounded-2xl bg-gradient-to-r from-green-50 to-emerald-50 p-4 text-center border border-green-200 shadow-lg animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx("svg",{className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"font-bold text-green-900",children:"Order Placed Successfully!"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"You are now in the queue."})]})}),T&&v==="default"&&(!l||l.status==="completed")&&e.jsxs("div",{className:"mb-8 relative w-full animate-fade-in-up rounded-2xl border border-primary-200 bg-white p-6 shadow-lg",children:[e.jsx("button",{onClick:()=>b(!1),className:"absolute top-4 right-4 rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600","aria-label":"Dismiss",children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-primary-100 text-primary-600",children:e.jsx(R,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Get Order Updates"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Enable notifications to know exactly when your coffee is ready for pickup."}),e.jsx("button",{onClick:D,className:"mt-4 rounded-full bg-primary-600 px-6 py-2 text-sm font-semibold text-white transition-all hover:bg-primary-700 hover:shadow-lg",children:"Enable Notifications"})]})]})]}),t&&e.jsx("div",{className:"mb-10",children:e.jsx("div",{className:"grid grid-cols-3 gap-4 sm:gap-6",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-2xl p-5 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-50 flex items-center justify-center mb-3 group-hover:bg-blue-100 transition-colors",children:e.jsx(L,{className:"h-6 w-6 text-blue-600"})}),e.jsx("p",{className:"text-3xl font-bold text-coffee-900",children:t.totalOrders||0}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mt-1",children:"Orders"})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-5 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-amber-50 flex items-center justify-center mb-3 group-hover:bg-amber-100 transition-colors",children:e.jsx(Ne,{className:"h-6 w-6 text-amber-600"})}),e.jsx("p",{className:"text-3xl font-bold text-coffee-900",children:t.currentPoints||0}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mt-1",children:"Points"})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-5 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-50 flex items-center justify-center mb-3 group-hover:bg-green-100 transition-colors",children:e.jsx(be,{className:"h-6 w-6 text-green-600"})}),e.jsx("p",{className:"text-2xl font-bold text-coffee-900 capitalize",children:t.tier||"Bronze"}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mt-1",children:"Tier"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(Q,{}),e.jsx(Q,{})]})})}),O.length>0&&e.jsxs("div",{className:"w-full mb-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[e.jsx("h2",{className:"text-lg font-bold text-coffee-900",children:"Recent Orders"}),n.filter(s=>s.status==="completed").length>2&&e.jsxs(P,{to:"/profile",className:"text-sm font-semibold text-primary-600 hover:text-primary-700 transition-colors flex items-center gap-1",children:["View All ",e.jsx(ue,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"space-y-4",children:O.map(s=>{const d=s.orderItems[0],j=d?se(d.productId):null;return e.jsx("div",{className:"bg-white rounded-2xl p-5 shadow-md border border-gray-100 hover:shadow-xl transition-all duration-300 group",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"flex-shrink-0 h-20 w-20 rounded-2xl overflow-hidden bg-gray-100 shadow-inner group-hover:scale-105 transition-transform duration-300",children:j?e.jsx("img",{src:j,alt:d.productName,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsx(C,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h3",{className:"font-bold text-coffee-900 text-lg truncate pr-4",children:(d==null?void 0:d.productName)||"Coffee Order"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:new Date(s.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3 font-mono",children:["Order #",s.orderNumber]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700",children:"Completed"}),s.orderItems.length>1&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.orderItems.length-1," more"]})]}),e.jsxs("p",{className:"text-lg font-bold text-primary-600",children:["â‚±",s.totalAmount.toFixed(2)]})]})]})]})},s.id)})})]}),e.jsx("div",{className:"w-full max-w-md mx-auto mt-8 mb-12",children:y?e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg border border-gray-100 text-center animate-pulse",children:[e.jsx("div",{className:"mb-4 relative mx-auto w-32 h-32 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-4"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded"})]}):o?e.jsxs(e.Fragment,{children:[O.length>0?e.jsx("h2",{className:"text-center text-xs font-bold text-gray-400 uppercase tracking-wider mb-6",children:"Recommended for You"}):e.jsxs("div",{className:"text-center mb-8 animate-fade-in-up",children:[e.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-3 bg-amber-50 px-4 py-2 rounded-full",children:[e.jsx(je,{className:"h-5 w-5 text-amber-500"}),e.jsx("h2",{className:"text-sm font-bold text-amber-900",children:"Start Your Journey"})]}),e.jsx("p",{className:"text-gray-600",children:"Try our most popular drink to get started!"})]}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-xl border border-gray-100 text-center relative overflow-hidden group hover:shadow-2xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-4 right-4 bg-amber-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10",children:"Top Pick"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"mb-6 relative mx-auto w-32 h-32 sm:w-40 sm:h-40",children:[e.jsx("div",{className:"absolute inset-0 bg-primary-200 rounded-full blur-2xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"}),e.jsx("img",{src:o.imageUrl,alt:o.name,className:"w-full h-full object-cover rounded-full shadow-lg group-hover:scale-110 transition-transform duration-500"})]}),e.jsx("h3",{className:"text-xl sm:text-2xl font-display font-bold text-gray-900 mb-2",children:o.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 line-clamp-2 px-4 leading-relaxed",children:o.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[e.jsxs("button",{onClick:()=>ee(o),className:"w-full sm:flex-1 bg-primary-600 text-white font-bold py-3.5 px-6 rounded-xl shadow-lg shadow-primary-600/20 hover:bg-primary-700 hover:shadow-primary-600/40 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Add to Cart"]}),e.jsx("button",{onClick:()=>S("/menu"),className:"w-full sm:w-auto bg-gray-50 text-gray-700 font-bold py-3.5 px-6 rounded-xl border border-gray-200 hover:bg-white hover:border-gray-300 hover:shadow-md transition-all",children:"View Menu"})]})]})]})]}):O.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 border-2 border-dashed border-gray-200 text-center",children:[e.jsx(C,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet. Your coffee journey starts here! â˜•"}),e.jsx("button",{onClick:()=>S("/menu"),className:"mt-6 inline-flex items-center justify-center gap-2 rounded-full bg-primary-600 px-6 py-2.5 font-semibold text-white shadow-md transition-all hover:bg-primary-700",children:"Start a New Order"})]})})]}),u&&e.jsx(he,{product:u,selectedSize:u.sizes[0],isOpen:M,onClose:()=>I(!1),onConfirm:te}),e.jsx(V,{})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50",children:[e.jsx(G,{}),e.jsx("main",{className:"flex flex-1 items-center justify-center px-6 py-20 text-center",children:e.jsxs("div",{children:[e.jsx(me,{className:"mx-auto h-24 w-24 text-gray-300 opacity-50"}),e.jsx("h1",{className:"mt-4 font-display text-2xl font-bold text-coffee-900",children:"You're not in the queue"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Please log in and place an order to see your queue status."}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[e.jsx(P,{to:"/auth/login",className:"rounded-full bg-primary-600 px-8 py-3 font-semibold text-white transition-transform hover:scale-105 shadow-lg",children:"Login"}),e.jsx(P,{to:"/menu",className:"rounded-full border-2 border-primary-600 px-8 py-3 font-semibold text-primary-600 transition-transform hover:scale-105 hover:bg-primary-50 shadow-sm",children:"View Menu"})]})]})}),e.jsx(V,{})]})};export{Ye as default};
