import{c as Q,h as ee,j as e,r as c,n as te,o as se,u as ae,H as re,X as oe,p as ne,i as ie,s as _,F as le,P as ce}from"./index-D0VROO4j.js";import{S as de}from"./star-s_t-t3Xa.js";import{S as me}from"./sparkles-ce6AQFdY.js";import{P as ue}from"./ProductCardSkeleton-Cg332WyX.js";import{S as H}from"./search-tx0CyJhj.js";import{A as he}from"./arrow-up-down-CDfPA_nN.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],ge=Q("mic-off",fe);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],xe=Q("mic",pe),be=({product:u,onAddToCart:q,onBuyNow:P,onProductClick:b,isLoggedIn:k})=>{const{name:v,category:w,imageUrl:n,comboImageUrl:A,available:g,stock:O,popular:R,new:h}=u,i=ee(),S=u.sizes[0],T=S.name==="Combo Meal"&&A?A:n,l=!g||O===0,p=()=>{b?b(u,S):k?q(u,S):i("/auth/login")},f=d=>{!l&&(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),p())};return e.jsxs("div",{role:"button",tabIndex:l?-1:0,onClick:l?void 0:p,onKeyDown:f,className:`w-full text-left rounded-2xl overflow-hidden bg-white shadow-sm border transition-all ${l?"opacity-60 cursor-not-allowed":"cursor-pointer hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] border-gray-200 hover:border-primary-300"}`,children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("img",{src:T,alt:v,className:"w-full h-full object-cover"}),l&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm",children:"Out of Stock"})}),O>0&&O<5&&!l&&e.jsx("div",{className:"absolute top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded-lg text-xs font-bold",children:"Low Stock"}),R&&!l&&e.jsx("div",{className:"absolute top-2 left-2 rounded-full bg-amber-100 p-1.5 text-amber-600 shadow-sm",title:"Popular",children:e.jsx(de,{className:"h-4 w-4 fill-current"})}),h&&!l&&e.jsx("div",{className:"absolute top-10 left-2 rounded-full bg-blue-100 p-1.5 text-blue-600 shadow-sm",title:"New",children:e.jsx(me,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:w}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm md:text-base mb-2 line-clamp-1",children:v}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg md:text-xl font-bold text-primary-700",children:["₱",S.price.toFixed(2)]}),!l&&!k&&e.jsx("button",{onClick:d=>{d.stopPropagation(),i("/auth/login")},className:"text-xs md:text-sm font-bold text-primary-600 hover:text-primary-700 underline",children:"Login"})]})]})]})},we=({onSearch:u,onCommand:q,language:P="en-US"})=>{const[b,k]=c.useState(!1),[v,w]=c.useState(!0),n=c.useRef(null),[A,g]=c.useState(null);c.useEffect(()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){w(!1);return}const h=window.SpeechRecognition||window.webkitSpeechRecognition;return n.current=new h,n.current.continuous=!1,n.current.interimResults=!1,n.current.lang=P,n.current.onstart=()=>{k(!0),g(null)},n.current.onend=()=>{k(!1)},n.current.onresult=i=>{const S=i.results[0][0].transcript;console.log("Voice result:",S),O(S)},n.current.onerror=i=>{console.error("Speech recognition error",i.error),k(!1),i.error==="network"?g(P==="tl-PH"?"Tagalog mode requires internet.":"Network error. Check internet or permissions."):i.error==="not-allowed"?g("Mic access denied."):i.error==="no-speech"?g("No speech detected."):g("Voice error. Try again.")},()=>{n.current&&n.current.abort()}},[P]);const O=h=>{const i=h.toLowerCase().trim(),S=["i want","order","get me","can i have","add","add to cart","show me","show me the","go to","view","open","gusto ko ng","gusto ko","pabili ng","order ako ng","dagdag","patingin ng","patingin sa","punta sa","buksan"],T=["pre","pare","tol","boss","idol","po","opo","please","naman","sana","thanks","thank you","cart","sa","to","ng","the","my","ko","mo"];let l=!1;for(const p of S)if(i.includes(p)){const f=i.split(p);if(f.length>1){let d=f[1].trim();d=d.replace(/[.,?!]+$/,"");let z=d.split(/\s+/);for(;z.length>0&&T.includes(z[z.length-1]);)z.pop();if(d=z.join(" "),d){q("order",d),l=!0;break}}}if(!l){let p=i.replace(/[.,?!]+$/,""),f=p.split(/\s+/);for(;f.length>0&&T.includes(f[f.length-1]);)f.pop();p=f.join(" "),u(p)}},R=()=>{var h,i;if(g(null),b)(h=n.current)==null||h.stop();else{if(!navigator.onLine){g("No Internet Connection");return}(i=n.current)==null||i.start()}};return v?e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsxs("button",{onClick:R,className:`relative flex h-12 w-12 items-center justify-center rounded-full backdrop-blur-sm transition-all duration-300 ${b?"bg-red-500 text-white shadow-[0_0_15px_rgba(239,68,68,0.5)] animate-pulse":A?"bg-red-500/20 text-red-500 ring-1 ring-red-500/50":"bg-white/10 text-white ring-1 ring-white/20 hover:bg-white/20"}`,title:A||(b?"Listening...":"Voice Search"),children:[b?e.jsx(ge,{className:"h-5 w-5"}):e.jsx(xe,{className:"h-5 w-5"}),b&&e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"})]}),A&&e.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 whitespace-nowrap rounded bg-red-500 px-2 py-1 text-[10px] font-medium text-white shadow-lg",children:[A,e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 border-4 border-transparent border-b-red-500"})]})]}):null},ye=[{value:"default",label:"Default"},{value:"price-asc",label:"Price: Low to High"},{value:"price-desc",label:"Price: High to Low"},{value:"name-asc",label:"Name: A-Z"},{value:"name-desc",label:"Name: Z-A"}],ve={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},je={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},Le=()=>{const{products:u,isLoading:q,error:P}=te(),[b,k]=c.useState("All"),[v,w]=c.useState(""),[n,A]=c.useState("default"),[g,O]=c.useState(!1),R=c.useRef(null),h=c.useRef(null),{addToCart:i}=se(),{currentUser:S}=ae(),[T,l]=c.useState(!1),[p,f]=c.useState(null),[d,z]=c.useState(null),[F,$]=c.useState(1),W=(s,t)=>{["Coffee Based","Non Coffee","Refreshments","Matcha Series"].includes(s.category)?(f(s),z(t),l(!0)):i(s,t)},Z=(s,t,a,o)=>{if(p&&(o||d)){const j=o||d;j&&i(p,j,s,t)}},D=s=>{let t=s.toLowerCase(),a=1,o="";const j={one:1,isa:1,isang:1,two:2,dalawa:2,dalawang:2,three:3,tatlo:3,tatlong:3,four:4,apat:4,"apat na":4,five:5,lima:5,limang:5,six:6,anim:6,"anim na":6,seven:7,pito:7,pitong:7,eight:8,walo:8,walong:8,nine:9,siyam:9,"siyam na":9,ten:10,sampu:10,sampung:10},N=t.match(/(\d+)/);if(N)a=parseInt(N[0]),t=t.replace(N[0],"").trim();else for(const[m,r]of Object.entries(j)){const C=new RegExp(`\\b${m}\\b`,"i");if(C.test(t)){a=r,t=t.replace(C,"").trim();break}}t.match(/\b(venti|large|malaki|22oz|big)\b/)?(o="Venti",t=t.replace(/\b(venti|large|malaki|22oz|big)\b/g,"").trim()):t.match(/\b(grande|medium|regular|16oz|small|maliit)\b/)?(o="Grande",t=t.replace(/\b(grande|medium|regular|16oz|small|maliit)\b/g,"").trim()):t.match(/\b(combo|meal|with drink)\b/)?(o="Combo Meal",t=t.replace(/\b(combo|meal|with drink)\b/g,"").trim()):t.match(/\b(ala carte|solo|fries only)\b/)&&(o="Ala Carte",t=t.replace(/\b(ala carte|solo|fries only)\b/g,"").trim()),t=t.replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim();const L=["please","paki","ng","sa","ang","yung","po","order","want","get","have","ko","the","a","an","i","my","for","me","category","show","view","menu","list","go","to","open"],x=t.split(" ").filter(m=>!L.includes(m)).join(" ");console.log("Voice Search Debug:",{term:s,lowerTerm:t,cleanTerm:x,productsCount:u.length});let M=u.find(m=>m.name.toLowerCase()===x);return M||(M=u.find(m=>{var E;const r=m.name.toLowerCase(),C=r.includes(x)||x.includes(r),B=(E=m.aliases)==null?void 0:E.some(Y=>{const U=Y.toLowerCase();return U.includes(x)||x.includes(U)});return C||B})),!M&&x!==t&&(M=u.find(m=>{var C;const r=m.name.toLowerCase();return r.includes(t)||t.includes(r)||((C=m.aliases)==null?void 0:C.some(B=>{const E=B.toLowerCase();return E.includes(t)||t.includes(E)}))})),{foundProduct:M,quantity:a,targetSizeName:o,cleanTerm:x}},V={all:"All",lahat:"All",everything:"All",coffee:"Coffee Based","coffee based":"Coffee Based",kape:"Coffee Based","non coffee":"Non-Coffee Based","non-coffee":"Non-Coffee Based","non coffee based":"Non-Coffee Based",noncoffee:"Non-Coffee Based","hindi kape":"Non-Coffee Based",matcha:"Matcha Series","matcha series":"Matcha Series",refreshment:"Refreshments",refreshments:"Refreshments",inumin:"Refreshments",pampalamig:"Refreshments",meal:"Meals",meals:"Meals",food:"Meals",snack:"Meals",pagkain:"Meals",meryenda:"Meals"},G=s=>{var x,M,m;const t=s.toLowerCase(),{foundProduct:a,quantity:o,targetSizeName:j,cleanTerm:N}=D(s),L=Object.keys(V).find(r=>r===N);if(console.log("Category Match Debug:",{cleanTerm:N,exactCategoryMatch:L,keys:Object.keys(V)}),L){const r=V[L];k(r),w(""),(x=h.current)==null||x.scrollIntoView({behavior:"smooth"});return}if(a){f(a);let r=a.sizes[0];if(j){const C=a.sizes.find(B=>B.name===j);C&&(r=C)}z(r),$(o),l(!0),w("");return}const I=Object.keys(V).sort((r,C)=>C.length-r.length).find(r=>t.includes(r));if(I){const r=V[I];k(r),w(""),(M=h.current)==null||M.scrollIntoView({behavior:"smooth"});return}w(s),(m=h.current)==null||m.scrollIntoView({behavior:"smooth"})},X=(s,t)=>{var N,L;const a=t.toLowerCase();if(console.log("Voice command received:",s,"Term:",a),s==="order"){const{foundProduct:y,quantity:I,targetSizeName:x}=D(t);if(y){let M=y.sizes[0];if(x){const m=y.sizes.find(r=>r.name===x);m&&(M=m)}f(y),z(M),$(I),l(!0),w("");return}}const j=Object.keys(V).sort((y,I)=>I.length-y.length).find(y=>a===y||a.includes(y));if(j){const y=V[j];k(y),w(""),(N=h.current)==null||N.scrollIntoView({behavior:"smooth"});return}w(t),(L=h.current)==null||L.scrollIntoView({behavior:"smooth"})},J=c.useMemo(()=>u.length===0?["All"]:["All",...[...new Set(u.map(t=>t.category))].sort()],[u]);c.useEffect(()=>{const s=t=>{R.current&&!R.current.contains(t.target)&&O(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const K=c.useMemo(()=>{const t=[...u.filter(a=>{var N;const o=b==="All"||a.category===b,j=v.trim()===""||a.name.toLowerCase().includes(v.toLowerCase())||a.description.toLowerCase().includes(v.toLowerCase())||((N=a.aliases)==null?void 0:N.some(L=>L.toLowerCase().includes(v.toLowerCase())));return o&&j})];switch(n){case"price-asc":t.sort((a,o)=>a.sizes[0].price-o.sizes[0].price);break;case"price-desc":t.sort((a,o)=>o.sizes[0].price-a.sizes[0].price);break;case"name-asc":t.sort((a,o)=>a.name.localeCompare(o.name));break;case"name-desc":t.sort((a,o)=>o.name.localeCompare(a.name));break}return t},[b,v,u,n]);return e.jsxs("div",{className:"flex min-h-screen flex-col bg-white",children:[e.jsx(re,{}),e.jsxs("main",{children:[e.jsxs("section",{className:"relative flex min-h-[40vh] items-center justify-center bg-primary-900 px-6 py-16 text-center text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=2574&auto=format&fit=crop')] bg-cover bg-center opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-900/80 to-primary-900/90"}),e.jsxs("div",{className:"container relative z-40 mx-auto max-w-4xl animate-fade-in-up",children:[e.jsx("h1",{className:"font-display text-4xl font-bold md:text-5xl",children:"Our Menu"}),e.jsx("p",{className:"mt-2 text-lg text-gray-200",children:"Discover your perfect cup ☕"}),e.jsxs("div",{className:"mx-auto mt-8 flex max-w-2xl gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(H,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:v,onChange:s=>w(s.target.value),placeholder:"Search for coffee, matcha...",className:"w-full rounded-full border-0 bg-white/10 py-3 pl-12 pr-10 text-white placeholder:text-gray-400 ring-1 ring-white/20 transition focus:bg-white/20 focus:ring-2 focus:ring-primary-500"}),v&&e.jsx("button",{onClick:()=>w(""),className:"absolute right-3 top-1/2 -translate-y-1/2 rounded-full p-1 text-gray-400 hover:bg-white/10 hover:text-white",title:"Clear search",children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsx(we,{onSearch:G,onCommand:X}),e.jsxs("div",{className:"relative shrink-0",ref:R,children:[e.jsx("button",{onClick:()=>O(!g),className:"flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-white backdrop-blur-sm ring-1 ring-white/20 transition hover:bg-white/20","aria-haspopup":"true","aria-expanded":g,"aria-label":"Sort products",children:e.jsx(he,{className:"h-5 w-5"})}),e.jsx("div",{className:`absolute right-0 top-full z-[100] mt-2 w-56 origin-top-right rounded-xl border border-gray-100 bg-white p-1 shadow-xl ring-1 ring-black ring-opacity-5 transition-all duration-200 ease-out ${g?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu","aria-orientation":"vertical",children:e.jsx("div",{className:"py-1",role:"none",children:ye.map(s=>e.jsxs("button",{onClick:()=>{A(s.value),O(!1)},className:`flex w-full items-center justify-between rounded-lg px-4 py-2.5 text-sm text-left font-medium transition-colors ${n===s.value?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,role:"menuitem",children:[e.jsx("span",{children:s.label}),n===s.value&&e.jsx(ne,{className:"h-4 w-4"})]},s.value))})})]})]})]})]}),e.jsx("div",{className:"sticky top-16 z-20 border-b border-gray-200 bg-white/95 py-3 backdrop-blur-sm sm:top-20",children:e.jsx("div",{className:"container mx-auto flex max-w-7xl gap-2 overflow-x-auto px-6 pb-2",children:J.map(s=>e.jsx("button",{onClick:()=>{var t;k(s),(t=h.current)==null||t.scrollIntoView({behavior:"smooth"})},className:`flex-shrink-0 rounded-full px-4 py-2 text-sm font-semibold transition-colors ${b===s?"bg-primary-600 text-white shadow":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-100"}`,children:s},s))})}),e.jsx("section",{ref:h,className:"bg-gray-50 px-6 py-8 scroll-mt-36",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:q?e.jsx("div",{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:Array.from({length:8}).map((s,t)=>e.jsx(ue,{},t))}):P?e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-red-200 bg-red-50 py-20 text-center text-red-700",children:[e.jsx(ie,{className:"h-16 w-16"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"Oops! Something went wrong."}),e.jsx("p",{className:"mt-2",children:P})]}):K.length>0?e.jsx(_.div,{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",variants:ve,initial:"hidden",animate:"visible",children:K.map(s=>e.jsx(_.div,{variants:je,layout:!0,className:"flex",children:e.jsx(be,{product:s,onAddToCart:W,onProductClick:(t,a)=>{f(t),z(a),l(!0)},isLoggedIn:!!S})},s.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(H,{className:"h-24 w-24 text-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"No products found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Try adjusting your filters or search query."})]})})})]}),e.jsx(le,{}),p&&d&&e.jsx(ce,{product:p,selectedSize:d,isOpen:T,onClose:()=>l(!1),onConfirm:Z,initialQuantity:F})]})};export{Le as default};
