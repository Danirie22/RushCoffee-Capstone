import{c as j,r as g,j as e,C as l,d as N}from"./index-6FamDUS3.js";import{R as v,B as y,X as w,Y as k,T as F,a as S,C,S as A}from"./SalesOverview-Cg8ZlDOL.js";import{M as R}from"./message-square-BuTmF6Di.js";import{S as B}from"./star-CVbCg3el.js";import{T as D}from"./thumbs-up-B5OJM7DU.js";import"./trending-up-BuD0ndp8.js";import"./package-BUfghy3a.js";import"./clock-DKb6jZ7P.js";import"./calendar-Zh7iaO3E.js";import"./arrow-up-down-Cl-OVMEq.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],E=j("thumbs-down",$),M=["#10B981","#F59E0B","#EF4444"],L=({feedbackData:c,isLoading:h})=>{const t=g.useMemo(()=>{if(!c.length)return null;const s=c.filter(a=>a.rating>0),r=s.length;if(r===0)return null;const d=s.reduce((a,n)=>a+n.rating,0)/r,o=s.filter(a=>a.rating===5).length,i=s.filter(a=>a.rating<=3).length,m=Math.round((o-i)/r*100),x=[{name:"Positive (5★)",value:o},{name:"Neutral (4★)",value:s.filter(a=>a.rating===4).length},{name:"Negative (1-3★)",value:i}],f=["food","service","system","other"].map(a=>{const n=s.filter(u=>u.category===a),p=n.length?n.reduce((u,b)=>u+b.rating,0)/n.length:0;return{name:a.charAt(0).toUpperCase()+a.slice(1),rating:Number(p.toFixed(1)),count:n.length}}).filter(a=>a.count>0);return{avgRating:d,nps:m,sentimentData:x,categoryData:f,totalReviews:r}},[c]);return h?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8",children:[e.jsx(l,{className:"h-80 animate-pulse bg-gray-100",children:e.jsx("div",{})}),e.jsx(l,{className:"h-80 animate-pulse bg-gray-100",children:e.jsx("div",{})})]}):t?e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Customer Satisfaction & Feedback"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(l,{className:"flex items-center justify-between p-6 bg-gradient-to-br from-yellow-50 to-amber-50 border-amber-100",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Average Rating"}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsx("span",{className:"text-3xl font-bold text-amber-900",children:t.avgRating.toFixed(1)}),e.jsx("div",{className:"flex text-amber-500",children:[...Array(5)].map((s,r)=>e.jsx(B,{className:`w-4 h-4 ${r<Math.round(t.avgRating)?"fill-current":"text-amber-200"}`},r))})]}),e.jsxs("p",{className:"text-xs text-amber-700 mt-1",children:["Based on ",t.totalReviews," reviews"]})]})}),e.jsxs(l,{className:`flex items-center justify-between p-6 bg-gradient-to-br ${t.nps>0?"from-green-50 to-emerald-50 border-emerald-100":"from-red-50 to-rose-50 border-rose-100"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${t.nps>0?"text-emerald-800":"text-rose-800"}`,children:"Net Promoter Score (NPS)"}),e.jsx("div",{className:"flex items-baseline gap-2 mt-1",children:e.jsxs("span",{className:`text-3xl font-bold ${t.nps>0?"text-emerald-900":"text-rose-900"}`,children:[t.nps>0?"+":"",t.nps]})}),e.jsx("p",{className:`text-xs mt-1 ${t.nps>0?"text-emerald-700":"text-rose-700"}`,children:t.nps>50?"Excellent":t.nps>0?"Good":"Needs Improvement"})]}),e.jsx("div",{className:`p-3 rounded-full ${t.nps>0?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"}`,children:t.nps>0?e.jsx(D,{className:"w-6 h-6"}):e.jsx(E,{className:"w-6 h-6"})})]}),e.jsx(l,{className:"flex items-center justify-between p-6 bg-white border-gray-100",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-3",children:"Sentiment Distribution"}),e.jsx("div",{className:"flex h-4 w-full rounded-full overflow-hidden",children:t.sentimentData.map((s,r)=>e.jsx("div",{style:{width:`${s.value/t.totalReviews*100}%`,backgroundColor:M[r]},title:`${s.name}: ${s.value}`},s.name))}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"Pos"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),"Neu"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),"Neg"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Rating by Category"}),e.jsx("div",{className:"h-64",children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(y,{data:t.categoryData,layout:"vertical",margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(w,{type:"number",domain:[0,5],hide:!0}),e.jsx(k,{dataKey:"name",type:"category",width:80,tick:{fontSize:12}}),e.jsx(F,{cursor:{fill:"transparent"}}),e.jsx(S,{dataKey:"rating",fill:"#8B5CF6",radius:[0,4,4,0],barSize:20,background:{fill:"#F3F4F6"},children:t.categoryData.map((s,r)=>e.jsx(C,{fill:s.rating>=4.5?"#10B981":s.rating>=4?"#8B5CF6":"#F59E0B"},`cell-${r}`))})]})})})]}),e.jsxs(l,{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Feedback Volume Trend"}),e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400 text-sm bg-gray-50 rounded-lg border border-dashed border-gray-200",children:"Chart placeholder (Requires historical data aggregation)"})]})]})]}):e.jsxs(l,{className:"mt-8 text-center py-12",children:[e.jsx(R,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No Feedback Data"}),e.jsx("p",{className:"text-gray-500",children:"Collect more customer feedback to see satisfaction metrics."})]})},X=()=>{const[c,h]=g.useState([]),[t,s]=g.useState(!0);return g.useEffect(()=>{(async()=>{s(!0);try{const o=(await N.collection("feedback").orderBy("createdAt","desc").limit(100).get()).docs.map(i=>{var m,x;return{id:i.id,...i.data(),createdAt:(m=i.data().createdAt)==null?void 0:m.toDate(),updatedAt:(x=i.data().updatedAt)==null?void 0:x.toDate()}});h(o)}catch(d){console.error("Error fetching feedback:",d)}finally{s(!1)}})()},[]),e.jsxs("div",{className:"space-y-8",children:[e.jsx(A,{}),e.jsx("div",{className:"border-t border-gray-200 pt-8",children:e.jsx(L,{feedbackData:c,isLoading:t})})]})};export{X as default};
