import{f as D,r as l,j as e,S as E,m as R,n as q,u as I,H as U,o as H,h as T,p as O,F}from"./index-C0udEWay.js";import{S as V}from"./star-ZPQWvlRV.js";import{S as B}from"./sparkles-CStqRtCk.js";import{P as K}from"./ProductCardSkeleton-bwqg6bVQ.js";import{P as Q}from"./ProductCustomizeModal-Bvo29JfB.js";import{S as M}from"./search-rLTdvGQg.js";import{A as Z}from"./arrow-up-down-DtuCVE-J.js";import"./seedCustomizationOptions-8x4KZtbH.js";import"./mockCustomizationOptions-CwPUP-Xn.js";const _=({product:i,onAddToCart:N,onBuyNow:C,onProductClick:d,isLoggedIn:f})=>{const{name:c,category:S,imageUrl:x,comboImageUrl:v,available:p,stock:m,popular:g,new:j}=i,b=D(),[u,k]=l.useState(i.sizes[0]),y=u.name==="Combo Meal"&&v?v:x,a=!p||m===0,w=()=>{d?d(i,u):f?N(i,u):b("/auth/login")},h=o=>{!a&&(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),w())};return e.jsxs("div",{role:"button",tabIndex:a?-1:0,onClick:a?void 0:w,onKeyDown:h,className:`w-full text-left rounded-2xl overflow-hidden bg-white shadow-sm border transition-all ${a?"opacity-60 cursor-not-allowed":"cursor-pointer hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] border-gray-200 hover:border-coffee-300"}`,children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("img",{src:y,alt:c,className:"w-full h-full object-cover"}),a&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm",children:"Out of Stock"})}),m>0&&m<5&&!a&&e.jsx("div",{className:"absolute top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded-lg text-xs font-bold",children:"Low Stock"}),g&&!a&&e.jsx("div",{className:"absolute top-2 left-2 rounded-full bg-amber-100 p-1.5 text-amber-600 shadow-sm",title:"Popular",children:e.jsx(V,{className:"h-4 w-4 fill-current"})}),j&&!a&&e.jsx("div",{className:"absolute top-10 left-2 rounded-full bg-blue-100 p-1.5 text-blue-600 shadow-sm",title:"New",children:e.jsx(B,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:S}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm md:text-base mb-2 line-clamp-1",children:c}),e.jsx("div",{className:"flex gap-1 mb-3",children:i.sizes.map((o,P)=>e.jsx("button",{onClick:z=>{z.stopPropagation(),k(o)},className:`flex-1 py-1.5 px-2 rounded-lg text-xs font-semibold transition-colors ${u.name===o.name?"bg-coffee-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:o.name},`${o.name}-${P}`))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg md:text-xl font-bold text-coffee-700",children:["₱",u.price.toFixed(2)]}),!a&&f&&e.jsx("div",{className:"h-9 w-9 md:h-10 md:w-10 rounded-full bg-coffee-600 flex items-center justify-center text-white shadow-md",children:e.jsx(E,{className:"h-5 w-5 md:h-6 md:w-6"})}),!a&&!f&&e.jsx("button",{onClick:o=>{o.stopPropagation(),b("/auth/login")},className:"text-xs md:text-sm font-bold text-coffee-600 hover:text-coffee-700 underline",children:"Login"})]})]})]})},G=[{value:"default",label:"Default"},{value:"price-asc",label:"Price: Low to High"},{value:"price-desc",label:"Price: High to Low"},{value:"name-asc",label:"Name: A-Z"},{value:"name-desc",label:"Name: Z-A"}],J={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},W={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},ie=()=>{const{products:i,isLoading:N,error:C}=R(),[d,f]=l.useState("All"),[c,S]=l.useState(""),[x,v]=l.useState("default"),[p,m]=l.useState(!1),g=l.useRef(null),j=l.useRef(null),{addToCart:b}=q(),{currentUser:u}=I(),[k,y]=l.useState(!1),[a,w]=l.useState(null),[h,o]=l.useState(null),P=(t,s)=>{["Coffee Based","Non Coffee","Refreshments","Matcha Series"].includes(t.category)?(w(t),o(s),y(!0)):b(t,s)},z=(t,s)=>{a&&h&&b(a,h,t,s)},L=l.useMemo(()=>i.length===0?["All"]:["All",...[...new Set(i.map(s=>s.category))].sort()],[i]);l.useEffect(()=>{const t=s=>{g.current&&!g.current.contains(s.target)&&m(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const A=l.useMemo(()=>{const s=[...i.filter(r=>{const n=d==="All"||r.category===d,$=c.trim()===""||r.name.toLowerCase().includes(c.toLowerCase())||r.description.toLowerCase().includes(c.toLowerCase());return n&&$})];switch(x){case"price-asc":s.sort((r,n)=>r.sizes[0].price-n.sizes[0].price);break;case"price-desc":s.sort((r,n)=>n.sizes[0].price-r.sizes[0].price);break;case"name-asc":s.sort((r,n)=>r.name.localeCompare(n.name));break;case"name-desc":s.sort((r,n)=>n.name.localeCompare(r.name));break}return s},[d,c,i,x]);return e.jsxs("div",{className:"flex min-h-screen flex-col bg-white",children:[e.jsx(U,{}),e.jsxs("main",{children:[e.jsxs("section",{className:"relative flex min-h-[40vh] items-center justify-center bg-coffee-900 px-6 py-16 text-center text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=2574&auto=format&fit=crop')] bg-cover bg-center opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-coffee-900/80 to-coffee-900/90"}),e.jsxs("div",{className:"container relative z-40 mx-auto max-w-4xl",children:[e.jsx("h1",{className:"font-display text-4xl font-bold md:text-5xl",children:"Our Menu"}),e.jsx("p",{className:"mt-2 text-lg text-gray-200",children:"Discover your perfect cup ☕"}),e.jsxs("div",{className:"mx-auto mt-8 flex max-w-2xl gap-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(M,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:t=>S(t.target.value),placeholder:"Search for coffee, matcha...",className:"w-full rounded-full border-0 bg-white/10 py-3 pl-12 pr-4 text-white placeholder:text-gray-400 ring-1 ring-white/20 transition focus:bg-white/20 focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"relative shrink-0",ref:g,children:[e.jsx("button",{onClick:()=>m(!p),className:"flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-white backdrop-blur-sm ring-1 ring-white/20 transition hover:bg-white/20","aria-haspopup":"true","aria-expanded":p,"aria-label":"Sort products",children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsx("div",{className:`absolute right-0 top-full z-[100] mt-2 w-56 origin-top-right rounded-xl border border-gray-100 bg-white p-1 shadow-xl ring-1 ring-black ring-opacity-5 transition-all duration-200 ease-out ${p?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu","aria-orientation":"vertical",children:e.jsx("div",{className:"py-1",role:"none",children:G.map(t=>e.jsxs("button",{onClick:()=>{v(t.value),m(!1)},className:`flex w-full items-center justify-between rounded-lg px-4 py-2.5 text-sm text-left font-medium transition-colors ${x===t.value?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,role:"menuitem",children:[e.jsx("span",{children:t.label}),x===t.value&&e.jsx(H,{className:"h-4 w-4"})]},t.value))})})]})]})]})]}),e.jsx("div",{className:"sticky top-16 z-20 border-b border-gray-200 bg-white/95 py-3 backdrop-blur-sm sm:top-20",children:e.jsx("div",{className:"container mx-auto flex max-w-7xl gap-2 overflow-x-auto px-6 pb-2",children:L.map(t=>e.jsx("button",{onClick:()=>{var s;f(t),(s=j.current)==null||s.scrollIntoView({behavior:"smooth"})},className:`flex-shrink-0 rounded-full px-4 py-2 text-sm font-semibold transition-colors ${d===t?"bg-primary-600 text-white shadow":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-100"}`,children:t},t))})}),e.jsx("section",{ref:j,className:"bg-gray-50 px-6 py-8 scroll-mt-36",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:N?e.jsx("div",{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:Array.from({length:8}).map((t,s)=>e.jsx(K,{},s))}):C?e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-red-200 bg-red-50 py-20 text-center text-red-700",children:[e.jsx(T,{className:"h-16 w-16"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"Oops! Something went wrong."}),e.jsx("p",{className:"mt-2",children:C})]}):A.length>0?e.jsx(O.div,{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",variants:J,initial:"hidden",animate:"visible",children:A.map(t=>e.jsx(O.div,{variants:W,layout:!0,className:"flex",children:e.jsx(_,{product:t,onAddToCart:P,onProductClick:(s,r)=>{w(s),o(r),y(!0)},isLoggedIn:!!u})},t.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(M,{className:"h-24 w-24 text-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"No products found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Try adjusting your filters or search query."})]})})})]}),e.jsx(F,{}),a&&h&&e.jsx(Q,{product:a,selectedSize:h,isOpen:k,onClose:()=>y(!1),onConfirm:z})]})};export{ie as default};
