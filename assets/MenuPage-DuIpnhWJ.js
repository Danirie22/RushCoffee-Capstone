import{c as H,f as Y,j as e,r as c,m as J,n as ee,u as te,H as se,X as ae,o as re,h as oe,p as K,F as ne,P as ie}from"./index-hoivcvTL.js";import{S as le}from"./star-BUIo-gao.js";import{S as ce}from"./sparkles-Db9JqNUm.js";import{P as de}from"./ProductCardSkeleton-BgY1cdG8.js";import{S as _}from"./search-BicICMdH.js";import{A as me}from"./arrow-up-down-COJ27CAu.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],he=H("mic-off",ue);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],pe=H("mic",fe),ge=({product:u,onAddToCart:V,onBuyNow:b,onProductClick:g,isLoggedIn:w})=>{const{name:d,category:y,imageUrl:i,comboImageUrl:A,available:L,stock:h,popular:T,new:C}=u,k=Y(),o=u.sizes[0],v=o.name==="Combo Meal"&&A?A:i,x=!L||h===0,S=()=>{g?g(u,o):w?V(u,o):k("/auth/login")},j=l=>{!x&&(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),S())};return e.jsxs("div",{role:"button",tabIndex:x?-1:0,onClick:x?void 0:S,onKeyDown:j,className:`w-full text-left rounded-2xl overflow-hidden bg-white shadow-sm border transition-all ${x?"opacity-60 cursor-not-allowed":"cursor-pointer hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] border-gray-200 hover:border-primary-300"}`,children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("img",{src:v,alt:d,className:"w-full h-full object-cover"}),x&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm",children:"Out of Stock"})}),h>0&&h<5&&!x&&e.jsx("div",{className:"absolute top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded-lg text-xs font-bold",children:"Low Stock"}),T&&!x&&e.jsx("div",{className:"absolute top-2 left-2 rounded-full bg-amber-100 p-1.5 text-amber-600 shadow-sm",title:"Popular",children:e.jsx(le,{className:"h-4 w-4 fill-current"})}),C&&!x&&e.jsx("div",{className:"absolute top-10 left-2 rounded-full bg-blue-100 p-1.5 text-blue-600 shadow-sm",title:"New",children:e.jsx(ce,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:y}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm md:text-base mb-2 line-clamp-1",children:d}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg md:text-xl font-bold text-primary-700",children:["₱",o.price.toFixed(2)]}),!x&&!w&&e.jsx("button",{onClick:l=>{l.stopPropagation(),k("/auth/login")},className:"text-xs md:text-sm font-bold text-primary-600 hover:text-primary-700 underline",children:"Login"})]})]})]})},D=()=>({speak:c.useCallback(V=>{if(!("speechSynthesis"in window)){console.warn("Text-to-speech not supported in this browser.");return}window.speechSynthesis.cancel();const b=new SpeechSynthesisUtterance(V),w=window.speechSynthesis.getVoices().find(d=>d.name.includes("Google US English")||d.name.includes("Microsoft Zira")||d.lang==="en-US"&&d.name.includes("Female"));w&&(b.voice=w),b.rate=1.1,b.pitch=1.1,b.volume=1,window.speechSynthesis.speak(b)},[])}),xe=({onSearch:u,onCommand:V,language:b="en-US"})=>{const[g,w]=c.useState(!1),[d,y]=c.useState(!0),i=c.useRef(null),{speak:A}=D(),[L,h]=c.useState(null);c.useEffect(()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){y(!1);return}const k=window.SpeechRecognition||window.webkitSpeechRecognition;return i.current=new k,i.current.continuous=!1,i.current.interimResults=!1,i.current.lang=b,i.current.onstart=()=>{w(!0),h(null)},i.current.onend=()=>{w(!1)},i.current.onresult=o=>{const v=o.results[0][0].transcript;console.log("Voice result:",v),T(v)},i.current.onerror=o=>{console.error("Speech recognition error",o.error),w(!1),o.error==="network"?b==="tl-PH"?(h("Tagalog mode requires internet."),A("Please check your internet connection.")):(h("Network error. Check internet or permissions."),A("Please check your internet connection.")):o.error==="not-allowed"?(h("Mic access denied."),A("Please enable microphone access.")):o.error==="no-speech"?h("No speech detected."):(h("Voice error. Try again."),A("Sorry, I didn't catch that."))},()=>{i.current&&i.current.abort()}},[b]);const T=k=>{const o=k.toLowerCase().trim(),v=["i want","order","get me","can i have","add","add to cart","show me","show me the","go to","view","open","gusto ko ng","gusto ko","pabili ng","order ako ng","dagdag","patingin ng","patingin sa","punta sa","buksan"],x=["pre","pare","tol","boss","idol","po","opo","please","naman","sana","thanks","thank you","cart","sa","to","ng","the","my","ko","mo"];let S=!1;for(const j of v)if(o.includes(j)){const l=o.split(j);if(l.length>1){let M=l[1].trim();M=M.replace(/[.,?!]+$/,"");let P=M.split(/\s+/);for(;P.length>0&&x.includes(P[P.length-1]);)P.pop();if(M=P.join(" "),M){V("order",M),S=!0;break}}}if(!S){let j=o.replace(/[.,?!]+$/,""),l=j.split(/\s+/);for(;l.length>0&&x.includes(l[l.length-1]);)l.pop();j=l.join(" "),u(j)}},C=()=>{var k,o;if(h(null),g)(k=i.current)==null||k.stop();else{if(!navigator.onLine){h("No Internet Connection");return}(o=i.current)==null||o.start()}};return d?e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsxs("button",{onClick:C,className:`relative flex h-12 w-12 items-center justify-center rounded-full backdrop-blur-sm transition-all duration-300 ${g?"bg-red-500 text-white shadow-[0_0_15px_rgba(239,68,68,0.5)] animate-pulse":L?"bg-red-500/20 text-red-500 ring-1 ring-red-500/50":"bg-white/10 text-white ring-1 ring-white/20 hover:bg-white/20"}`,title:L||(g?"Listening...":"Voice Search"),children:[g?e.jsx(he,{className:"h-5 w-5"}):e.jsx(pe,{className:"h-5 w-5"}),g&&e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"})]}),L&&e.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 whitespace-nowrap rounded bg-red-500 px-2 py-1 text-[10px] font-medium text-white shadow-lg",children:[L,e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 border-4 border-transparent border-b-red-500"})]})]}):null},be=[{value:"default",label:"Default"},{value:"price-asc",label:"Price: Low to High"},{value:"price-desc",label:"Price: High to Low"},{value:"name-asc",label:"Name: A-Z"},{value:"name-desc",label:"Name: Z-A"}],we={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},ye={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},Me=()=>{const{products:u,isLoading:V,error:b}=J(),[g,w]=c.useState("All"),[d,y]=c.useState(""),[i,A]=c.useState("default"),[L,h]=c.useState(!1),T=c.useRef(null),C=c.useRef(null),{addToCart:k}=ee(),{currentUser:o}=te(),{speak:v}=D(),[x,S]=c.useState(!1),[j,l]=c.useState(null),[M,P]=c.useState(null),[F,q]=c.useState(1),Q=(s,t)=>{["Coffee Based","Non Coffee","Refreshments","Matcha Series"].includes(s.category)?(l(s),P(t),S(!0)):k(s,t)},Z=(s,t,a,r)=>{if(j&&(r||M)){const p=r||M;p&&k(j,p,s,t)}},B=s=>{let t=s.toLowerCase(),a=1,r="";const p={one:1,isa:1,isang:1,two:2,dalawa:2,dalawang:2,three:3,tatlo:3,tatlong:3,four:4,apat:4,"apat na":4,five:5,lima:5,limang:5,six:6,anim:6,"anim na":6,seven:7,pito:7,pitong:7,eight:8,walo:8,walong:8,nine:9,siyam:9,"siyam na":9,ten:10,sampu:10,sampung:10},z=t.match(/(\d+)/);if(z)a=parseInt(z[0]),t=t.replace(z[0],"").trim();else for(const[f,I]of Object.entries(p)){const O=new RegExp(`\\b${f}\\b`,"i");if(O.test(t)){a=I,t=t.replace(O,"").trim();break}}t.match(/\b(venti|large|malaki|22oz|big)\b/)?(r="Venti",t=t.replace(/\b(venti|large|malaki|22oz|big)\b/g,"").trim()):t.match(/\b(grande|medium|regular|16oz|small|maliit)\b/)?(r="Grande",t=t.replace(/\b(grande|medium|regular|16oz|small|maliit)\b/g,"").trim()):t.match(/\b(combo|meal|with drink)\b/)?(r="Combo Meal",t=t.replace(/\b(combo|meal|with drink)\b/g,"").trim()):t.match(/\b(ala carte|solo|fries only)\b/)&&(r="Ala Carte",t=t.replace(/\b(ala carte|solo|fries only)\b/g,"").trim()),t=t.replace(/\s+/g," ").trim();const R=["please","paki","ng","sa","ang","yung","po","order","want","get","have","ko"],n=t.split(" ").filter(f=>!R.includes(f)).join(" ");let N=u.find(f=>f.name.toLowerCase()===n);return N||(N=u.find(f=>{var I;return f.name.toLowerCase().includes(n)||((I=f.aliases)==null?void 0:I.some(O=>O.toLowerCase().includes(n)))})),!N&&n!==t&&(N=u.find(f=>{var I;return f.name.toLowerCase().includes(t)||((I=f.aliases)==null?void 0:I.some(O=>O.toLowerCase().includes(t)))})),{foundProduct:N,quantity:a,targetSizeName:r,cleanTerm:n}},U={all:"All",lahat:"All",everything:"All",coffee:"Coffee Based","coffee based":"Coffee Based",kape:"Coffee Based","non coffee":"Non-Coffee Based","non-coffee":"Non-Coffee Based","non coffee based":"Non-Coffee Based",noncoffee:"Non-Coffee Based","hindi kape":"Non-Coffee Based",matcha:"Matcha Series","matcha series":"Matcha Series",refreshment:"Refreshments",refreshments:"Refreshments",inumin:"Refreshments",pampalamig:"Refreshments",meal:"Meals",meals:"Meals",food:"Meals",snack:"Meals",pagkain:"Meals",meryenda:"Meals"},G=s=>{var $,m;const t=s.toLowerCase(),r=Object.keys(U).sort((n,N)=>N.length-n.length).find(n=>t.includes(n));if(r){const n=U[r];w(n),y(""),($=C.current)==null||$.scrollIntoView({behavior:"smooth"}),v(`Showing ${n} menu.`);return}const{foundProduct:p,quantity:z,targetSizeName:R}=B(s);if(p){l(p);let n=p.sizes[0];if(R){const N=p.sizes.find(f=>f.name===R);N&&(n=N)}P(n),q(z),S(!0),y(""),v(`I found ${p.name}. How would you like that?`);return}v(`Searching for ${s}`),y(s),(m=C.current)==null||m.scrollIntoView({behavior:"smooth"})},W=(s,t)=>{var z,R,$;const a=t.toLowerCase();console.log("Voice command received:",s,"Term:",a);const p=Object.keys(U).sort((m,n)=>n.length-m.length).find(m=>a===m||a.includes(m));if(p){const m=U[p];w(m),y(""),(z=C.current)==null||z.scrollIntoView({behavior:"smooth"}),v(`Here is our ${m} menu.`);return}if(s==="order"){const{foundProduct:m,quantity:n,targetSizeName:N}=B(t);if(m){let f=m.sizes[0];if(N){const I=m.sizes.find(O=>O.name===N);I&&(f=I)}l(m),P(f),q(n),S(!0),y(""),v(`I've selected ${n} ${m.name}. You can customize it now.`)}else v(`Sorry, I couldn't find ${t} on the menu.`),y(t),(R=C.current)==null||R.scrollIntoView({behavior:"smooth"})}else y(t),($=C.current)==null||$.scrollIntoView({behavior:"smooth"})},X=c.useMemo(()=>u.length===0?["All"]:["All",...[...new Set(u.map(t=>t.category))].sort()],[u]);c.useEffect(()=>{const s=t=>{T.current&&!T.current.contains(t.target)&&h(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const E=c.useMemo(()=>{const t=[...u.filter(a=>{var z;const r=g==="All"||a.category===g,p=d.trim()===""||a.name.toLowerCase().includes(d.toLowerCase())||a.description.toLowerCase().includes(d.toLowerCase())||((z=a.aliases)==null?void 0:z.some(R=>R.toLowerCase().includes(d.toLowerCase())));return r&&p})];switch(i){case"price-asc":t.sort((a,r)=>a.sizes[0].price-r.sizes[0].price);break;case"price-desc":t.sort((a,r)=>r.sizes[0].price-a.sizes[0].price);break;case"name-asc":t.sort((a,r)=>a.name.localeCompare(r.name));break;case"name-desc":t.sort((a,r)=>r.name.localeCompare(a.name));break}return t},[g,d,u,i]);return e.jsxs("div",{className:"flex min-h-screen flex-col bg-white",children:[e.jsx(se,{}),e.jsxs("main",{children:[e.jsxs("section",{className:"relative flex min-h-[40vh] items-center justify-center bg-primary-900 px-6 py-16 text-center text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=2574&auto=format&fit=crop')] bg-cover bg-center opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-900/80 to-primary-900/90"}),e.jsxs("div",{className:"container relative z-40 mx-auto max-w-4xl animate-fade-in-up",children:[e.jsx("h1",{className:"font-display text-4xl font-bold md:text-5xl",children:"Our Menu"}),e.jsx("p",{className:"mt-2 text-lg text-gray-200",children:"Discover your perfect cup ☕"}),e.jsxs("div",{className:"mx-auto mt-8 flex max-w-2xl gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(_,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:d,onChange:s=>y(s.target.value),placeholder:"Search for coffee, matcha...",className:"w-full rounded-full border-0 bg-white/10 py-3 pl-12 pr-10 text-white placeholder:text-gray-400 ring-1 ring-white/20 transition focus:bg-white/20 focus:ring-2 focus:ring-primary-500"}),d&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 -translate-y-1/2 rounded-full p-1 text-gray-400 hover:bg-white/10 hover:text-white",title:"Clear search",children:e.jsx(ae,{className:"h-4 w-4"})})]}),e.jsx(xe,{onSearch:G,onCommand:W}),e.jsxs("div",{className:"relative shrink-0",ref:T,children:[e.jsx("button",{onClick:()=>h(!L),className:"flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-white backdrop-blur-sm ring-1 ring-white/20 transition hover:bg-white/20","aria-haspopup":"true","aria-expanded":L,"aria-label":"Sort products",children:e.jsx(me,{className:"h-5 w-5"})}),e.jsx("div",{className:`absolute right-0 top-full z-[100] mt-2 w-56 origin-top-right rounded-xl border border-gray-100 bg-white p-1 shadow-xl ring-1 ring-black ring-opacity-5 transition-all duration-200 ease-out ${L?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu","aria-orientation":"vertical",children:e.jsx("div",{className:"py-1",role:"none",children:be.map(s=>e.jsxs("button",{onClick:()=>{A(s.value),h(!1)},className:`flex w-full items-center justify-between rounded-lg px-4 py-2.5 text-sm text-left font-medium transition-colors ${i===s.value?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,role:"menuitem",children:[e.jsx("span",{children:s.label}),i===s.value&&e.jsx(re,{className:"h-4 w-4"})]},s.value))})})]})]})]})]}),e.jsx("div",{className:"sticky top-16 z-20 border-b border-gray-200 bg-white/95 py-3 backdrop-blur-sm sm:top-20",children:e.jsx("div",{className:"container mx-auto flex max-w-7xl gap-2 overflow-x-auto px-6 pb-2",children:X.map(s=>e.jsx("button",{onClick:()=>{var t;w(s),(t=C.current)==null||t.scrollIntoView({behavior:"smooth"})},className:`flex-shrink-0 rounded-full px-4 py-2 text-sm font-semibold transition-colors ${g===s?"bg-primary-600 text-white shadow":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-100"}`,children:s},s))})}),e.jsx("section",{ref:C,className:"bg-gray-50 px-6 py-8 scroll-mt-36",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:V?e.jsx("div",{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:Array.from({length:8}).map((s,t)=>e.jsx(de,{},t))}):b?e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-red-200 bg-red-50 py-20 text-center text-red-700",children:[e.jsx(oe,{className:"h-16 w-16"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"Oops! Something went wrong."}),e.jsx("p",{className:"mt-2",children:b})]}):E.length>0?e.jsx(K.div,{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",variants:we,initial:"hidden",animate:"visible",children:E.map(s=>e.jsx(K.div,{variants:ye,layout:!0,className:"flex",children:e.jsx(ge,{product:s,onAddToCart:Q,onProductClick:(t,a)=>{l(t),P(a),S(!0)},isLoggedIn:!!o})},s.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(_,{className:"h-24 w-24 text-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"No products found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Try adjusting your filters or search query."})]})})})]}),e.jsx(ne,{}),j&&M&&e.jsx(ie,{product:j,selectedSize:M,isOpen:x,onClose:()=>S(!1),onConfirm:Z,initialQuantity:F})]})};export{Me as default};
