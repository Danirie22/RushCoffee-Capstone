import{c as ae,r as i,h as X,p as K,o as ee,E as G,j as e,I as z,s as m,a as y,d as R,D as N,J as re,x as ie,u as oe,t as ne,n as le,K as ce,N as de,H as $,R as me,L as F,F as V,X as xe,T as ue,A as he,O as fe,P as ge}from"./index-LHjwylzb.js";import{D as H}from"./DigitalReceipt-BgvlPBRK.js";import{B as Y}from"./bell-0-m0T600.js";import{C as T}from"./coffee-DYJFl-fZ.js";import{C as P}from"./clock-BokvIW9m.js";import{S as pe}from"./star-BLUEBzkS.js";import{T as ye}from"./thumbs-up-BEX5cSy0.js";import{S as Ne}from"./shopping-bag-DVE8aW7y.js";import{A as be}from"./award-DfippjFs.js";import{S as we}from"./sparkles-BFoT4hoD.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],Z=ae("receipt",je),ve=({delay:t})=>{const r=Math.random()*300-150,o=Math.random()*300+50,g=Math.random()*360,b=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"],w=b[Math.floor(Math.random()*b.length)];return e.jsx(m.div,{initial:{opacity:1,x:0,y:-20,scale:.5,rotate:0},animate:{opacity:[1,1,0],x:r,y:o,scale:[.5,1,.5],rotate:g},transition:{duration:2.5,delay:t,ease:"easeOut"},style:{position:"absolute",top:0,left:"50%",width:"8px",height:"8px",backgroundColor:w,borderRadius:Math.random()>.5?"50%":"2px",zIndex:50}})},Me=()=>{const t=Array.from({length:60});return e.jsx("div",{className:"absolute top-0 left-0 right-0 h-full pointer-events-none overflow-hidden z-50",children:t.map((r,o)=>e.jsx(ve,{delay:Math.random()*.3},o))})},W={waiting:{Icon:P,text:"Order Placed",subtext:"We've received your order.",color:"text-amber-600",bgColor:"bg-amber-50",headerGradient:"from-amber-500 to-amber-600",step:1},preparing:{Icon:T,text:"Brewing Now",subtext:"Your coffee is being crafted.",color:"text-blue-600",bgColor:"bg-blue-50",headerGradient:"from-blue-500 to-blue-600",step:2},ready:{Icon:Y,text:"Ready for Pickup!",subtext:"Grab it at the counter.",color:"text-green-600",bgColor:"bg-green-50",headerGradient:"from-green-500 to-green-600",step:3},completed:{Icon:K,text:"Enjoy!",subtext:"Order completed.",color:"text-primary-600",bgColor:"bg-primary-50",headerGradient:"from-primary-600 to-primary-800",step:4}},Ie=({order:t,onDismiss:r})=>{const[o,g]=i.useState(!1),[b,w]=i.useState(!1),[A,E]=i.useState(!1),[j,C]=i.useState(0),[O,U]=i.useState(0),[v,k]=i.useState(""),[u,M]=i.useState(!1),I=X(),n=W[t.status]||W.waiting,{showToast:h}=ee();i.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),i.useEffect(()=>{const s=sessionStorage.getItem(`confetti_shown_${t.id}`);if(t.status==="ready"&&!s){w(!0),sessionStorage.setItem(`confetti_shown_${t.id}`,"true");const x=setTimeout(()=>w(!1),4e3);return()=>clearTimeout(x)}},[t.status,t.id]);const Q=()=>{I("/menu")},f=async()=>{if(!A){E(!0);try{let s=0;const x=[];if(t.orderItems.forEach(l=>{x.push(l.productName);const c=l.productName.toLowerCase();c.includes("grande")?s+=4*l.quantity:c.includes("venti")?s+=5*l.quantity:c.includes("ala carte")?s+=4*l.quantity:c.includes("combo")&&(s+=5*l.quantity)}),await R.collection("orders").doc(t.id).update({status:"completed",completedAt:new Date,updatedAt:new Date}),t.userId){const l={totalOrders:N.firestore.FieldValue.increment(1)};if(l.totalSpent=N.firestore.FieldValue.increment(t.totalAmount||t.orderItems.reduce((c,p)=>c+p.price*p.quantity,0)),s>0){l.currentPoints=N.firestore.FieldValue.increment(s),l.loyaltyPoints=N.firestore.FieldValue.increment(s);const c={id:`rh-${Date.now()}`,type:"earned",points:s,description:`Earned from ${x.join(", ")}`,date:new Date};l.rewardsHistory=N.firestore.FieldValue.arrayUnion(c)}await R.collection("users").doc(t.userId).update(l),s>0?h(`Order completed! Earned ${s} loyalty points!`):h("Order marked as completed!")}}catch(s){console.error("Error updating order status:",s),h("Failed to update order status. Please try again.")}finally{E(!1)}}};return t.status==="completed"?G.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs(m.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-sm overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:`bg-gradient-to-br ${n.headerGradient} px-6 py-8 text-center text-white relative overflow-hidden`,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsx(m.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20,delay:.1},className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10",children:e.jsx(K,{className:"h-8 w-8 text-white",strokeWidth:3})}),e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:"Enjoy your coffee!"}),e.jsxs("p",{className:"mt-1 text-primary-100 font-medium",children:["Order #",t.orderNumber," completed"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("p",{className:"mb-3 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:"How was your experience?"}),e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(s=>e.jsx(m.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>C(s),onMouseEnter:()=>U(s),onMouseLeave:()=>U(0),className:"focus:outline-none",children:e.jsx(pe,{className:`h-8 w-8 transition-colors duration-200 ${s<=(O||j)?"fill-amber-400 text-amber-400":"fill-gray-100 text-gray-300"}`})},s))}),e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{value:v,onChange:s=>k(s.target.value),placeholder:"Tell us more... (optional)",className:"w-full rounded-xl border-gray-200 bg-gray-50 p-3 text-sm text-gray-700 placeholder-gray-400 focus:border-primary-500 focus:bg-white focus:ring-primary-500 transition-all resize-none",rows:3})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{size:"lg",variant:"outline",className:"w-full rounded-xl border-2 border-gray-100 text-gray-700 hover:bg-gray-50 hover:border-gray-200 font-semibold py-3.5",onClick:()=>M(!0),children:[e.jsx(Z,{className:"mr-2 h-5 w-5"}),"View Receipt"]}),r&&e.jsx(y,{size:"lg",className:"w-full rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-lg hover:shadow-primary-600/30 transition-all font-bold py-3.5 text-base",onClick:async()=>{if(j>0)try{await R.collection("feedback").add({userId:t.userId,orderId:t.id,rating:j,category:"food",comment:v,status:"pending",createdAt:N.firestore.FieldValue.serverTimestamp(),updatedAt:N.firestore.FieldValue.serverTimestamp(),type:"review"}),h("Thank you for your feedback!")}catch(s){console.error("Error submitting feedback:",s)}I("/queue"),r&&r()},children:"Done"}),e.jsx(y,{size:"lg",variant:"ghost",className:"w-full rounded-xl text-primary-600 hover:bg-primary-50 font-semibold py-2",onClick:()=>I("/menu"),children:"Order Again"})]})]})]})]},"completed-modal")}),e.jsx(H,{order:t,isOpen:u,onClose:()=>M(!1)})]}),document.body):G.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),e.jsxs(m.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[b&&e.jsx(Me,{}),e.jsxs(m.div,{className:`relative overflow-hidden px-6 py-8 text-center text-white bg-gradient-to-br ${n.headerGradient}`,layout:!0,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(z,{mode:"wait",children:e.jsx(m.div,{initial:{scale:.8,opacity:0,rotate:-20},animate:{scale:1,opacity:1,rotate:0},exit:{scale:.8,opacity:0,rotate:20},transition:{type:"spring",stiffness:200,damping:15},className:"mb-3 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10 shadow-lg",children:e.jsx(n.Icon,{className:"h-8 w-8 text-white"})},t.status)}),e.jsx(z,{mode:"wait",children:e.jsxs(m.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.3},children:[e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:n.text}),e.jsx("p",{className:"mt-1 text-white/90 font-medium text-base",children:n.subtext})]},`${t.status}-text`)}),e.jsxs("div",{className:"mt-3 inline-flex items-center rounded-full bg-white/20 px-3 py-1 text-xs font-medium text-white backdrop-blur-md border border-white/10",children:["Order #",t.orderNumber]})]})]}),e.jsx("div",{className:"px-6 py-5 bg-white",children:e.jsxs("div",{className:"relative flex justify-between items-center",children:[e.jsx("div",{className:"absolute left-[20px] right-[20px] top-[16px] h-1 -translate-y-1/2 bg-gray-100 rounded-full z-0"}),e.jsx(m.div,{className:`absolute left-[20px] top-[16px] h-1 -translate-y-1/2 rounded-full z-0 bg-gradient-to-r ${n.headerGradient}`,initial:{width:"0%"},animate:{width:n.step===1?"0%":n.step===2?"50%":"calc(100% - 40px)"},transition:{duration:.5,ease:"easeInOut"}}),["waiting","preparing","ready"].map((s,x)=>{const l=x+1,c=n.step>=l,p=n.step===l;let S=P;return s==="preparing"&&(S=T),s==="ready"&&(S=Y),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(m.div,{animate:{scale:p?1.2:1,backgroundColor:"#fff",borderColor:c?"currentColor":"#E5E7EB",boxShadow:p?"0 10px 15px -3px rgba(0, 0, 0, 0.1)":"none"},transition:{duration:.3},className:`flex h-8 w-8 items-center justify-center rounded-full border-2 transition-colors duration-300 ${c?n.color.replace("text-","border-"):"border-gray-200 text-gray-300"}`,children:e.jsx(S,{className:`h-4 w-4 ${c?n.color:"text-gray-300"}`})}),e.jsx("span",{className:`mt-2 text-[10px] font-bold uppercase tracking-wider transition-colors duration-300 ${c?n.color:"text-gray-400"}`,children:s})]},s)})]})}),e.jsxs("div",{className:"border-t border-gray-100 bg-gray-50/50 px-6 py-5",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Estimated Wait"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-0.5",children:["~",t.estimatedTime," min"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Total Amount"}),e.jsxs("p",{className:"text-lg font-bold text-primary-600 mt-0.5",children:["â‚±",t.totalAmount.toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>g(!o),className:"flex w-full items-center justify-between rounded-xl bg-white px-4 py-3 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-gray-100 transition-all hover:bg-gray-50 hover:shadow-md",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-semibold",children:["View Order Items (",t.orderItems.length,")"]})]}),e.jsx(re,{className:`h-4 w-4 text-gray-400 transition-transform duration-300 ${o?"rotate-180":""}`})]}),e.jsx(z,{children:o&&e.jsxs(m.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden rounded-xl bg-white shadow-sm ring-1 ring-gray-100",children:[e.jsx("ul",{className:"divide-y divide-gray-50 px-5",children:t.orderItems.map((s,x)=>e.jsxs("li",{className:"flex justify-between py-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-gray-900 block",children:s.productName}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["Qty: ",s.quantity]})]}),e.jsxs("span",{className:"font-bold text-gray-600",children:["â‚±",(s.price*s.quantity).toFixed(2)]})]},x))}),e.jsx("div",{className:"p-3 border-t border-gray-50 bg-gray-50/50",children:e.jsxs(y,{size:"sm",variant:"ghost",className:"w-full text-xs font-semibold text-primary-600 hover:bg-primary-50",onClick:()=>M(!0),children:[e.jsx(Z,{className:"mr-2 h-3 w-3"}),"View Digital Receipt"]})})]})}),e.jsxs("div",{className:"pt-1 space-y-2",children:[t.status==="ready"?e.jsx(y,{variant:"primary",className:"w-full rounded-xl bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-green-600/30 transition-all py-3.5 text-base font-bold",onClick:f,disabled:A,children:A?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Updating..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"I've Received My Order"]})}):e.jsxs(y,{variant:"primary",className:"w-full rounded-xl bg-coffee-600 text-white hover:bg-coffee-700 shadow-lg hover:shadow-coffee-600/30 transition-all py-3.5 font-bold",onClick:Q,children:[e.jsx(Ne,{className:"mr-2 h-5 w-5"}),"Browse Menu"]}),e.jsxs(y,{variant:"ghost",className:"w-full rounded-xl text-gray-500 hover:bg-gray-100 font-semibold py-2.5",onClick:()=>I("/menu"),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Back to Menu"]})]})]})]})]})]},"active-modal")}),e.jsx(H,{order:t,isOpen:u,onClose:()=>M(!1)})]}),document.body)},De="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQ2IiBoZWlnaHQ9IjE3OCIgdmlld0JveD0iMCAwIDI0NiAxNzgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xNTQuNTAzIDgwQzE4MC41MDMgNTEgMjEzLjAwMyAyMC41IDIyNS41MDMgMTguNUMyMzguMDAzIDE2LjUgMjQ0LjAwMyAyOS41IDI0NC4wMDMgMjkuNUMyNDQuMDAzIDI5LjUgMjQ4LjUwMyA1Mi41IDI0MC41MDMgODBDMjMyLjUwMyAxMDcuNSAyMTEuNTAzIDEyNCAyMTEuNTAzIDEyNEMyMTEuNTAzIDEyNCAxNjYuNTAzIDE3MSAxNDcuMDAzIDE3NUMxNDcuMDAzIDE3NSAxMTkuMDAzIDE4MS41IDEwNy4wMDMgMTcyLjVDOTUuMDAyNSAxNjMuNSAxMjguNTAzIDEwOSAxNTQuNTAzIDgwWiIgZmlsbD0iIzc3M2UyMCIvPgo8cGF0aCBkPSJNMTIuMDAyNSA4OUMxMi4wMDI1IDg5IC0yMS4wMjkzIDIyLjAyMyAyMi41MDI1IDE3QzM1LjUwMjUgMTUuNSA4MC4wMDI1IDU2IDc5LjUwMjUgNTkuNUM4Mi41MDI1IDc1IDcyLjAwMjUgODcgNjQuNTAyNSA5N0M2MS4xMzM2IDEwMS40OTIgNjAuMDAyNSAxMDcuNSA1OC4wMDI1IDExOS41QzU4LjAwMjUgMTM5IDUzLjAwMjUgMTM4LjUgNTMuMDAyNSAxMzguNUM1My4wMDI1IDEzOC41IDQwLjUwMjUgMTQxIDEyLjAwMjUgODlaIiBmaWxsPSIjNzczZTIwIi8+CjxwYXRoIGQ9Ik00Ny4wMDI1IDE3QzQxLjAwMjUgMTIuMDAwMSA0Mi4wMDI1IC03LjYyOTM5ZS0wNiA1My4wMDI1IDBDNjQuMDAyNSA3LjYyOTRlLTA2IDc0LjE5MDQgNC43NjUzNCA4Ny4wMDI1IDEwQzEwMC4zNDcgMTUuNDUyMSAxMTAuOTExIDE5IDExNC41MDMgMjYuNUMxMTguMDk0IDM0IDExNC41MDMgMzkuNSAxMTAuMDAzIDQ1QzEwNS41MDMgNTAuNSAxMDIuMDAzIDUyIDk0LjUwMjUgNTFDODcuMDAyNSA1MCA1My4wMDI1IDIyIDQ3LjAwMjUgMTdaIiBmaWxsPSIjNzczZTIwIi8+CjxwYXRoIGQ9Ik0yMDUuNTAzIDIzLjVDMjE4LjUwMyAxNCAyMDUuNTAzIDUuNSAyMDUuNTAzIDUuNUMxNjIuMjM5IDEuNDMyNTIgMTIyLjQwOCAzMS45MzI0IDgyLjAwMjUgODguNUM3MS42NDU0IDEwMyA2Mi41NTgzIDE1MC4zMjIgNzguNTAyNSAxNjFDOTcuMTc4NCAxNzMuNTA4IDEwMi42MzQgMTY3LjEwOSAxMDMuNTAzIDEzMkMxMjEuNTAzIDUxIDE5Mi41MDMgMzMgMjA1LjUwMyAyMy41WiIgZmlsbD0iIzc3M2UyMCIvPgo8L3N2Zz4K";let J=null;const Ae=async()=>{if(console.log("[Notifications] ðŸ” Checking notification support..."),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported in this browser"),"denied";console.log("[Notifications] âœ… Notification API available"),console.log("[Notifications] Current permission:",Notification.permission);try{console.log("[Notifications] ðŸ“ Requesting notification permission...");const t=await Notification.requestPermission();return console.log("[Notifications] Permission result:",t),t}catch(t){return console.error("[Notifications] âŒ Error requesting notification permission:",t),"denied"}},Ce=async t=>{if(console.log("[Notifications] ðŸ”” Attempting to show notification:",t.title),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported"),!1;if(console.log("[Notifications] Current permission:",Notification.permission),Notification.permission!=="granted")return console.warn("[Notifications] âŒ Notification permission not granted. Current:",Notification.permission),!1;const r={body:t.body,icon:t.icon,tag:t.tag,badge:t.icon,vibrate:[200,100,200],requireInteraction:!1,data:t.data};console.log("[Notifications] Notification options:",r);try{if(J&&"showNotification"in J,"Notification"in window&&typeof Notification=="function"){console.log("[Notifications] ðŸ’» Using direct Notification API (fallback)");const o=new Notification(t.title,r);return o.onclick=()=>{console.log("[Notifications] ðŸ‘† Notification clicked"),window.focus(),o.close()},console.log("[Notifications] âœ… Direct notification shown successfully!"),!0}return console.warn("[Notifications] âŒ No notification method available"),!1}catch(o){return console.error("[Notifications] âŒ Error showing notification:",o),!1}},ke=()=>{if(!("Notification"in window))return"denied";const t=Notification.permission;return console.log("[Notifications] Current permission status:",t),t},_=()=>{const t="Notification"in window;return console.log("[Notifications] Notifications supported:",t),t},B=()=>e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-md border border-gray-100 text-center animate-pulse",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 mb-3"}),e.jsx("div",{className:"h-8 w-16 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"})]})}),Fe=()=>{var q;const{currentUser:t}=oe(),{activeOrder:r,orderHistory:o}=ne(),{products:g,isLoading:b}=le(),{addToCart:w,showToast:A}=ee(),E=ce(),j=X(),[C,O]=i.useState("default"),[U,v]=i.useState(!1),k=i.useRef(null),[u,M]=i.useState(null),[I,n]=i.useState(!1),[h,Q]=i.useState(()=>{const a=localStorage.getItem("dismissedOrderIds");return a?JSON.parse(a):[]});i.useEffect(()=>{localStorage.setItem("dismissedOrderIds",JSON.stringify(h))},[h]);const f=i.useMemo(()=>{const a=o.find(d=>d.status==="completed"&&!h.includes(d.id));return a||r||null},[r,o,h]),s=i.useMemo(()=>{const a=g.length>0?g:de;return a.length>0?a[0]:null},[g]),[x,l]=i.useState(((q=E.state)==null?void 0:q.fromCheckout)||!1);i.useEffect(()=>{if(x){const a=setTimeout(()=>{l(!1),window.history.replaceState({},document.title)},2e3);return()=>clearTimeout(a)}},[x]),i.useEffect(()=>{if(_()){const a=ke();O(a),a==="default"&&v(!0)}},[]),i.useEffect(()=>{r&&r.status==="ready"&&C==="granted"&&k.current!==r.id&&Ce({title:"Your Order is Ready! â˜•",body:`Your Rush Coffee order (${r.orderNumber}) is now ready for pickup.`,icon:De,tag:r.id,data:{orderId:r.id,orderNumber:r.orderNumber}}).then(a=>{a&&(console.log("Notification sent successfully"),k.current=r.id)}),(!r||r.status==="completed")&&(k.current=null)},[r,C]);const c=async()=>{if(!_()){alert("This browser does not support notifications");return}const a=await Ae();O(a),(a==="granted"||a==="denied")&&v(!1)},p=()=>{if(f){const a=[...h,f.id];Q(a),localStorage.setItem("dismissedOrderIds",JSON.stringify(a))}},S=a=>{M(a),n(!0)},te=(a,d)=>{if(u){const D=u.sizes[0];w(u,D,a,d),A(`Added ${d} ${u.name} to cart`),n(!1)}},L=i.useMemo(()=>o.filter(a=>a.status==="completed").slice(0,2),[o]),se=a=>{const d=g.find(D=>D.id===a);return(d==null?void 0:d.imageUrl)||null};return t?e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50 relative",children:[e.jsx($,{}),e.jsxs("section",{className:"relative overflow-hidden bg-gradient-to-br from-primary-900 via-primary-800 to-primary-900 px-6 py-12 text-white shadow-xl sm:py-20",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),e.jsx("div",{className:"absolute -right-20 -top-20 h-96 w-96 rounded-full bg-primary-500 blur-3xl opacity-20"}),e.jsx("div",{className:"absolute -left-20 -bottom-20 h-72 w-72 rounded-full bg-primary-500 blur-3xl opacity-20"}),e.jsxs("div",{className:"container relative mx-auto max-w-3xl text-center animate-fade-in-up",children:[e.jsxs("div",{className:"inline-flex items-center rounded-full bg-white/10 px-4 py-1.5 text-sm font-medium text-primary-100 backdrop-blur-sm ring-1 ring-white/20 mb-6",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Live Order Tracking"]}),e.jsx("h1",{className:"font-display text-4xl font-bold leading-tight tracking-tight md:text-5xl text-white mb-4",children:"Your Queue"}),e.jsx("p",{className:"text-lg text-primary-100 max-w-xl mx-auto",children:"Track your orders in real-time and see your coffee journey stats."})]})]}),e.jsxs("main",{className:"flex-1 w-full max-w-3xl mx-auto px-4 py-8 sm:py-12 relative z-10 -mt-10",children:[f&&e.jsx(Ie,{order:f,onDismiss:p}),x&&!f&&e.jsx("div",{className:"fixed top-24 left-1/2 -translate-x-1/2 z-50 w-full max-w-md px-4",children:e.jsxs("div",{className:"w-full rounded-2xl bg-gradient-to-r from-green-50 to-emerald-50 p-4 text-center border border-green-200 shadow-lg animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx("svg",{className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"font-bold text-green-900",children:"Order Placed Successfully!"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"You are now in the queue."})]})}),U&&C==="default"&&(!f||f.status==="completed")&&e.jsxs("div",{className:"mb-8 relative w-full animate-fade-in-up rounded-2xl border border-primary-200 bg-white p-6 shadow-lg",children:[e.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600","aria-label":"Dismiss",children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-primary-100 text-primary-600",children:e.jsx(Y,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Get Order Updates"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Enable notifications to know exactly when your coffee is ready for pickup."}),e.jsx("button",{onClick:c,className:"mt-4 rounded-full bg-primary-600 px-6 py-2 text-sm font-semibold text-white transition-all hover:bg-primary-700 hover:shadow-lg",children:"Enable Notifications"})]})]})]}),t&&e.jsx("div",{className:"mb-10",children:e.jsx("div",{className:"grid grid-cols-3 gap-4 sm:gap-6",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-100 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:e.jsx(P,{className:"h-7 w-7 text-blue-600"})}),e.jsx("h3",{className:"text-3xl font-display font-bold text-gray-900 mb-1",children:o.length}),e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Orders"})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-amber-100 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:e.jsx(be,{className:"h-7 w-7 text-amber-600"})}),e.jsx("h3",{className:"text-3xl font-display font-bold text-gray-900 mb-1",children:t.currentPoints}),e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Points"})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 text-center group",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-100 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:e.jsx(ue,{className:"h-7 w-7 text-green-600"})}),e.jsx("h3",{className:"text-3xl font-display font-bold text-gray-900 mb-1",children:t.currentPoints>=500?"Gold":t.currentPoints>=200?"Silver":"Bronze"}),e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Tier"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(B,{}),e.jsx(B,{})]})})}),L.length>0&&e.jsxs("div",{className:"w-full mb-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[e.jsx("h2",{className:"text-lg font-bold text-primary-900",children:"Recent Orders"}),o.filter(a=>a.status==="completed").length>2&&e.jsxs(F,{to:"/profile",className:"text-sm font-semibold text-primary-600 hover:text-primary-700 transition-colors flex items-center gap-1",children:["View All ",e.jsx(he,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"space-y-4",children:L.map(a=>{const d=a.orderItems[0],D=d?se(d.productId):null;return e.jsx("div",{className:"bg-white rounded-2xl p-5 shadow-md border border-gray-100 hover:shadow-xl transition-all duration-300 group",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"flex-shrink-0 h-20 w-20 rounded-2xl overflow-hidden bg-gray-100 shadow-inner group-hover:scale-105 transition-transform duration-300",children:D?e.jsx("img",{src:D,alt:d.productName,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsx(T,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h3",{className:"font-bold text-primary-900 text-lg truncate pr-4",children:(d==null?void 0:d.productName)||"Coffee Order"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:new Date(a.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3 font-mono",children:["Order #",a.orderNumber]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700",children:"Completed"}),a.orderItems.length>1&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",a.orderItems.length-1," more"]})]}),e.jsxs("p",{className:"text-lg font-bold text-primary-600",children:["â‚±",a.totalAmount.toFixed(2)]})]})]})]})},a.id)})})]}),e.jsx("div",{className:"w-full max-w-md mx-auto mt-8 mb-12",children:b?e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg border border-gray-100 text-center animate-pulse",children:[e.jsx("div",{className:"mb-4 relative mx-auto w-32 h-32 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-4"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded"})]}):s?e.jsxs(e.Fragment,{children:[L.length>0?e.jsx("h2",{className:"text-center text-xs font-bold text-gray-400 uppercase tracking-wider mb-6",children:"Recommended for You"}):e.jsxs("div",{className:"text-center mb-8 animate-fade-in-up",children:[e.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-3 bg-amber-50 px-4 py-2 rounded-full",children:[e.jsx(we,{className:"h-5 w-5 text-amber-500"}),e.jsx("h2",{className:"text-sm font-bold text-amber-900",children:"Start Your Journey"})]}),e.jsx("p",{className:"text-gray-600",children:"Try our most popular drink to get started!"})]}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-xl border border-gray-100 text-center relative overflow-hidden group hover:shadow-2xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-4 right-4 bg-amber-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10",children:"Top Pick"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"mb-6 relative mx-auto w-32 h-32 sm:w-40 sm:h-40",children:[e.jsx("div",{className:"absolute inset-0 bg-primary-200 rounded-full blur-2xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"}),e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover rounded-full shadow-lg group-hover:scale-110 transition-transform duration-500"})]}),e.jsx("h3",{className:"text-xl sm:text-2xl font-display font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 line-clamp-2 px-4 leading-relaxed",children:s.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[e.jsxs("button",{onClick:()=>S(s),className:"w-full sm:flex-1 bg-primary-600 text-white font-bold py-3.5 px-6 rounded-xl shadow-lg hover:bg-primary-700 hover:shadow-xl hover:scale-[1.01] active:scale-[0.99] transition-all flex items-center justify-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Add to Cart"]}),e.jsx("button",{onClick:()=>j("/menu"),className:"w-full sm:w-auto bg-gray-50 text-gray-700 font-bold py-3.5 px-6 rounded-xl border border-gray-200 hover:bg-white hover:border-gray-300 hover:shadow-md transition-all",children:"View Menu"})]})]})]})]}):L.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 border-2 border-dashed border-gray-200 text-center",children:[e.jsx(T,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet. Your coffee journey starts here! â˜•"}),e.jsx("button",{onClick:()=>j("/menu"),className:"mt-6 inline-flex items-center justify-center gap-2 rounded-full bg-primary-600 px-6 py-2.5 font-semibold text-white shadow-md transition-all hover:bg-primary-700",children:"Start a New Order"})]})})]}),u&&e.jsx(ge,{product:u,selectedSize:u.sizes[0],isOpen:I,onClose:()=>n(!1),onConfirm:te}),e.jsx(V,{})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50",children:[e.jsx($,{}),e.jsx("main",{className:"flex flex-1 items-center justify-center px-6 py-20 text-center",children:e.jsxs("div",{children:[e.jsx(me,{className:"mx-auto h-24 w-24 text-gray-300 opacity-50"}),e.jsx("h1",{className:"mt-4 font-display text-2xl font-bold text-primary-900",children:"You're not in the queue"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Please log in and place an order to see your queue status."}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[e.jsx(F,{to:"/auth/login",className:"rounded-full bg-primary-600 px-8 py-3 font-semibold text-white transition-transform hover:scale-105 shadow-lg",children:"Login"}),e.jsx(F,{to:"/menu",className:"rounded-full border-2 border-primary-600 px-8 py-3 font-semibold text-primary-600 transition-transform hover:scale-105 hover:bg-primary-50 shadow-sm",children:"View Menu"})]})]})}),e.jsx(V,{})]})};export{Fe as default};
