import{r,t as $,a4 as I,j as e,N as T,X as z,l as q,K as A,I as H}from"./index-ego2Aw0s.js";import{f as K}from"./seedCustomizationOptions-pnAppNLB.js";import{m as j}from"./mockCustomizationOptions-CwPUP-Xn.js";const Q=()=>{const[t,n]=r.useState(j),[d,l]=r.useState(!0),[x,f]=r.useState(null);return r.useEffect(()=>{(async()=>{try{l(!0);const a=await K();a&&a.sugarLevels&&a.iceLevels?(n(a),f(null)):n(j)}catch(a){console.error("Error fetching customization options:",a),f("Failed to load customization options"),n(j)}finally{l(!1)}})()},[]),{options:t,isLoading:d,error:x}},J=({product:t,selectedSize:n,isOpen:d,onClose:l,onConfirm:x,onBuyNow:f,initialCustomizations:o,initialQuantity:a=1})=>{const[N,g]=r.useState("100%"),[v,h]=r.useState("Normal"),[m,p]=r.useState("None"),[c,b]=r.useState(1),[u,w]=r.useState(n),{toppings:B,isLoading:M}=$(),{options:L,isLoading:E}=Q();I.useEffect(()=>{if(d){if(o){g(o.sugarLevel||"100%"),h(o.iceLevel||"Normal");const s=o.toppings&&o.toppings.length>0?o.toppings[0]:"None";p(s)}else g("100%"),h("Normal"),p("None");b(a),w(n)}},[d,o,a,n]);const O=()=>{const s=["Coffee Based","Non-Coffee Based","Matcha Series","Refreshments"].includes(t.category),i={toppings:m!=="None"?[m]:[]};return s&&(i.sugarLevel=N,i.iceLevel=v),i},F=()=>{x(O(),c,C/c,u),l()},S=[{id:"none",name:"None",price:0},...B.map(s=>({id:s.id,name:s.name,price:s.price}))],y=S.find(s=>s.name===m),P=(y==null?void 0:y.price)||0,C=(u.price+P)*c,k=M||E,R=e.jsxs("button",{onClick:F,disabled:k,className:"w-full flex items-center justify-between rounded-xl bg-gradient-to-r from-coffee-600 to-coffee-700 px-6 py-3 text-white font-bold shadow-lg hover:shadow-xl hover:scale-[1.01] active:scale-[0.99] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:"Add to Order"}),e.jsxs("span",{className:"text-lg tabular-nums",children:["₱",C.toFixed(2)]})]});return e.jsx(T,{isOpen:d,onClose:l,hideHeader:!0,hideCloseButton:!0,footer:R,className:"sm:max-w-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"-mx-6 -mt-6 mb-2",children:[e.jsxs("div",{className:"bg-[#F5F5F0] w-full h-96 flex items-center justify-center relative overflow-hidden",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 z-10 p-2 rounded-full bg-white/50 hover:bg-white/80 backdrop-blur-sm transition-colors text-gray-600 hover:text-gray-900",children:e.jsx(z,{className:"h-5 w-5"})}),e.jsx("img",{src:t.imageUrl,alt:t.name,className:"h-full w-full object-cover object-center"})]}),e.jsxs("div",{className:"px-6 pt-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:"text-sm font-medium text-coffee-600 tracking-wide uppercase",children:t.category})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.name}),e.jsx("p",{className:"text-gray-500 leading-relaxed text-sm",children:t.description})]})]}),k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-coffee-600"})}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"py-4 border-b border-gray-100 -mx-6 px-6",children:[e.jsx("h4",{className:"mb-3 text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:"Size"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.sizes.map(s=>e.jsx("button",{onClick:()=>w(s),className:`flex-1 min-w-[80px] rounded-lg py-2 text-sm font-semibold transition-all border ${u.name===s.name?"bg-coffee-600 text-white border-coffee-600 shadow-md":"bg-white text-gray-600 border-gray-200 hover:border-coffee-300 hover:bg-coffee-50"}`,children:s.name},s.name))})]}),["Coffee Based","Non-Coffee Based","Matcha Series","Refreshments"].includes(t.category)&&e.jsxs("div",{className:"py-4 border-b border-gray-100 -mx-6 px-6",children:[e.jsx("h4",{className:"mb-3 text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:"Sugar Level"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.sugarLevels.map(s=>e.jsx("button",{onClick:()=>g(s.value),className:`flex-1 min-w-[60px] rounded-lg py-2 text-sm font-semibold transition-all border ${N===s.value?"bg-coffee-600 text-white border-coffee-600 shadow-md":"bg-white text-gray-600 border-gray-200 hover:border-coffee-300 hover:bg-coffee-50"}`,children:s.value},s.value))})]}),["Coffee Based","Non-Coffee Based","Matcha Series","Refreshments"].includes(t.category)&&e.jsxs("div",{className:"py-4 border-b border-gray-100 -mx-6 px-6",children:[e.jsx("h4",{className:"mb-3 text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center gap-2",children:"Ice Level"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.iceLevels.map(s=>e.jsx("button",{onClick:()=>h(s.value),className:`flex-1 min-w-[60px] rounded-lg py-2 text-sm font-semibold transition-all border ${v===s.value?"bg-coffee-600 text-white border-coffee-600 shadow-md":"bg-white text-gray-600 border-gray-200 hover:border-coffee-300 hover:bg-coffee-50"}`,children:s.value},s.value))})]}),e.jsxs("div",{className:"py-4 border-b border-gray-100 -mx-6 px-6",children:[e.jsxs("h4",{className:"mb-3 text-sm font-bold text-gray-900 uppercase tracking-wide flex items-center justify-between",children:[e.jsx("span",{children:"Toppings"}),e.jsx("span",{className:"text-xs font-normal text-gray-500 normal-case",children:"Select one"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(s=>{const i=m===s.name;return e.jsxs("button",{onClick:()=>p(s.name),className:`
                                                relative px-3 py-2 rounded-lg text-sm font-medium transition-all border flex items-center gap-2
                                                ${i?"bg-coffee-50 border-coffee-600 text-coffee-700 shadow-sm ring-1 ring-coffee-600":"bg-white border-gray-200 text-gray-600 hover:border-coffee-300 hover:bg-gray-50"}
                                            `,children:[e.jsx("span",{children:s.name}),s.price>0&&e.jsxs("span",{className:`text-xs font-bold ${i?"text-coffee-600":"text-gray-400"}`,children:["+₱",s.price]})]},s.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 -mx-6 px-6",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-lg p-1 border border-gray-200",children:[e.jsx("button",{onClick:()=>b(Math.max(1,c-1)),className:"h-8 w-8 rounded-md bg-white shadow-sm flex items-center justify-center text-gray-600 hover:text-coffee-600 disabled:opacity-50 transition-colors",disabled:c<=1,children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-bold text-gray-900 tabular-nums",children:c}),e.jsx("button",{onClick:()=>b(c+1),className:"h-8 w-8 rounded-md bg-coffee-600 shadow-sm flex items-center justify-center text-white hover:bg-coffee-700 transition-colors",children:e.jsx(H,{className:"h-4 w-4"})})]})]})]})]})})};export{J as P};
