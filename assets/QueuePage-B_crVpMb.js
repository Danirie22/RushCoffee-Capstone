import{c as R,t as ne,v as Q,j as e,X,R as K,r as o,f as ee,o as te,n as se,x as A,p as x,y as le,d as Y,z as O,u as ce,s as de,m as me,D as xe,E as ue,H as V,L as U,F as q,I as he}from"./index-C0udEWay.js";import{B as y}from"./Button-BXzODrPk.js";import{B as F}from"./bell-CleamuHC.js";import{C as k}from"./coffee-7CoYvDIa.js";import{C as B}from"./clock-C0L02mkQ.js";import{S as fe}from"./star-ZPQWvlRV.js";import{T as pe}from"./thumbs-up-CBVpCa0Q.js";import{S as ge}from"./shopping-bag-DNX2AFCT.js";import{P as ye}from"./ProductCustomizeModal-Bvo29JfB.js";import{A as be}from"./award-BXFhFq9C.js";import{T as Ne}from"./trending-up-CKqYdS0J.js";import{S as $}from"./sparkles-CStqRtCk.js";import"./seedCustomizationOptions-8x4KZtbH.js";import"./mockCustomizationOptions-CwPUP-Xn.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],we=R("arrow-left",je);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Me=R("printer",ve);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],H=R("receipt",Ie),W=({order:t,isOpen:r,onClose:n})=>{if(ne.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),!r)return null;const h=()=>{window.print()};return Q.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 print:p-0 print:absolute print:inset-0 print:block print:bg-white",onClick:n,children:e.jsxs("div",{className:"flex flex-col w-full max-w-md max-h-[90vh] overflow-hidden rounded-3xl bg-white shadow-2xl print:max-w-none print:shadow-none print:rounded-none print:max-h-none print:overflow-visible animate-fade-in-up",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 p-4 print:hidden flex-shrink-0 bg-white z-10",children:[e.jsx("h3",{className:"font-display text-lg font-bold text-gray-900",children:"Digital Receipt"}),e.jsx("button",{onClick:n,className:"rounded-full p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition-colors",children:e.jsx(X,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 print:p-0 print:overflow-visible",id:"receipt-content",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx(K,{className:"mx-auto h-16 w-16 text-primary-600 mb-4"}),e.jsx("h1",{className:"font-display text-2xl font-bold text-coffee-900",children:"Rush Coffee"}),e.jsx("p",{className:"text-sm text-gray-500",children:"11 Visayan Ave. St. Galas, Quezon City"}),e.jsx("p",{className:"text-sm text-gray-500",children:"0930 464 1022"})]}),e.jsxs("div",{className:"mb-8 flex items-center justify-between border-b border-dashed border-gray-300 pb-6",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Order No."}),e.jsx("p",{className:"font-mono text-lg font-bold text-gray-900",children:t.orderNumber})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(t.timestamp).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Customer"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.customerName})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3",children:"Order Details"}),e.jsx("ul",{className:"space-y-3",children:t.orderItems.map((l,p)=>e.jsxs("li",{className:"flex justify-between text-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[l.quantity,"x ",l.productName]}),l.customizations&&e.jsxs("div",{className:"text-xs text-gray-500 pl-4 mt-0.5",children:[l.customizations.sugarLevel&&e.jsxs("span",{children:["Sugar: ",l.customizations.sugarLevel,", "]}),l.customizations.iceLevel&&e.jsxs("span",{children:["Ice: ",l.customizations.iceLevel]})]})]}),e.jsxs("span",{className:"font-medium text-gray-900",children:["â‚±",(l.price*l.quantity).toFixed(2)]})]},p))})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-300 pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["â‚±",(t.totalAmount-15).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Service Fee"}),e.jsx("span",{className:"font-medium text-gray-900",children:"â‚±15.00"})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold text-coffee-900 pt-2 border-t border-gray-100 mt-2",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["â‚±",t.totalAmount.toFixed(2)]})]})]}),e.jsxs("div",{className:"mt-6 rounded-lg bg-gray-50 p-4 text-center print:bg-transparent print:border print:border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Payment Method"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${t.paymentStatus==="paid"?"bg-green-500":"bg-amber-500"}`}),e.jsx("span",{className:"font-bold text-gray-900 uppercase",children:t.paymentMethod})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Status: ",e.jsx("span",{className:t.paymentStatus==="paid"?"text-green-600 font-medium":"text-amber-600 font-medium",children:t.paymentStatus==="paid"?"PAID":"PENDING"})]})]}),e.jsxs("div",{className:"mt-8 text-center border-t border-gray-100 pt-6",children:[e.jsx("p",{className:"font-display text-lg font-bold text-coffee-900 mb-1",children:"Thank You!"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Please present this receipt at the counter."}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-4 font-mono",children:t.id})]})]}),e.jsx("div",{className:"border-t border-gray-100 p-4 bg-gray-50 print:hidden flex-shrink-0 z-10",children:e.jsxs(y,{onClick:h,fullWidth:!0,className:"flex items-center justify-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Print Receipt"]})})]})}),e.jsx("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          #receipt-content, #receipt-content * {
            visibility: visible;
          }
          #receipt-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            margin: 0;
            padding: 20px;
          }
        }
      `})]}),document.body)},De=({delay:t})=>{const r=Math.random()*300-150,n=Math.random()*300+50,h=Math.random()*360,l=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"],p=l[Math.floor(Math.random()*l.length)];return e.jsx(x.div,{initial:{opacity:1,x:0,y:-20,scale:.5,rotate:0},animate:{opacity:[1,1,0],x:r,y:n,scale:[.5,1,.5],rotate:h},transition:{duration:2.5,delay:t,ease:"easeOut"},style:{position:"absolute",top:0,left:"50%",width:"8px",height:"8px",backgroundColor:p,borderRadius:Math.random()>.5?"50%":"2px",zIndex:50}})},Ae=()=>{const t=Array.from({length:60});return e.jsx("div",{className:"absolute top-0 left-0 right-0 h-full pointer-events-none overflow-hidden z-50",children:t.map((r,n)=>e.jsx(De,{delay:Math.random()*.3},n))})},_={waiting:{Icon:B,text:"Order Placed",subtext:"We've received your order.",color:"text-amber-600",bgColor:"bg-amber-50",headerGradient:"from-amber-500 to-amber-600",step:1},preparing:{Icon:k,text:"Brewing Now",subtext:"Your coffee is being crafted.",color:"text-blue-600",bgColor:"bg-blue-50",headerGradient:"from-blue-500 to-blue-600",step:2},ready:{Icon:F,text:"Ready for Pickup!",subtext:"Grab it at the counter.",color:"text-green-600",bgColor:"bg-green-50",headerGradient:"from-green-500 to-green-600",step:3},completed:{Icon:te,text:"Enjoy!",subtext:"Order completed.",color:"text-primary-600",bgColor:"bg-primary-50",headerGradient:"from-primary-600 to-primary-800",step:4}},ke=({order:t,onDismiss:r})=>{const[n,h]=o.useState(!1),[l,p]=o.useState(!1),[w,C]=o.useState(!1),[S,v]=o.useState(0),[z,T]=o.useState(0),[N,g]=o.useState(!1),u=ee(),d=_[t.status]||_.waiting,{showToast:M}=se();o.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),o.useEffect(()=>{const a=sessionStorage.getItem(`confetti_shown_${t.id}`);if(t.status==="ready"&&!a){p(!0),sessionStorage.setItem(`confetti_shown_${t.id}`,"true");const i=setTimeout(()=>p(!1),4e3);return()=>clearTimeout(i)}},[t.status,t.id]);const I=()=>{u("/menu")},b=async()=>{if(!w){C(!0);try{let a=0;if(t.orderItems.forEach(i=>{const m=i.productName.toLowerCase();m.includes("grande")?a+=4*i.quantity:m.includes("venti")?a+=5*i.quantity:m.includes("ala carte")?a+=4*i.quantity:m.includes("combo")&&(a+=5*i.quantity)}),await Y.collection("orders").doc(t.id).update({status:"completed",completedAt:new Date,updatedAt:new Date}),t.userId){const i={totalOrders:O.firestore.FieldValue.increment(1)};a>0&&(i.currentPoints=O.firestore.FieldValue.increment(a),i.loyaltyPoints=O.firestore.FieldValue.increment(a)),await Y.collection("users").doc(t.userId).update(i),a>0?M(`Order completed! Earned ${a} loyalty points!`):M("Order marked as completed!")}}catch(a){console.error("Error updating order status:",a),M("Failed to update order status. Please try again.")}finally{C(!1)}}};return t.status==="completed"?Q.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs(x.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-sm overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:`bg-gradient-to-br ${d.headerGradient} px-6 py-8 text-center text-white relative overflow-hidden`,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsx(x.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20,delay:.1},className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10",children:e.jsx(te,{className:"h-8 w-8 text-white",strokeWidth:3})}),e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:"Enjoy your coffee!"}),e.jsxs("p",{className:"mt-1 text-primary-100 font-medium",children:["Order #",t.orderNumber," completed"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("p",{className:"mb-3 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:"How was your experience?"}),e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(a=>e.jsx(x.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>v(a),onMouseEnter:()=>T(a),onMouseLeave:()=>T(0),className:"focus:outline-none",children:e.jsx(fe,{className:`h-8 w-8 transition-colors duration-200 ${a<=(z||S)?"fill-amber-400 text-amber-400":"fill-gray-100 text-gray-300"}`})},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{size:"lg",variant:"outline",className:"w-full rounded-xl border-2 border-gray-100 text-gray-700 hover:bg-gray-50 hover:border-gray-200 font-semibold py-3.5",onClick:()=>g(!0),children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),"View Receipt"]}),r&&e.jsx(y,{size:"lg",className:"w-full rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-lg hover:shadow-primary-600/30 transition-all font-bold py-3.5 text-base",onClick:()=>{u("/queue"),r&&r()},children:"Done"}),e.jsx(y,{size:"lg",variant:"ghost",className:"w-full rounded-xl text-primary-600 hover:bg-primary-50 font-semibold py-2",onClick:()=>u("/menu"),children:"Order Again"})]})]})]})]},"completed-modal")}),e.jsx(W,{order:t,isOpen:N,onClose:()=>g(!1)})]}),document.body):Q.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 sm:px-6",children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md overflow-hidden rounded-3xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto scrollbar-hide",children:[l&&e.jsx(Ae,{}),e.jsxs(x.div,{className:`relative overflow-hidden px-6 py-8 text-center text-white bg-gradient-to-br ${d.headerGradient}`,layout:!0,children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-10",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white"}),e.jsx("div",{className:"absolute bottom-10 -left-10 w-24 h-24 rounded-full bg-white"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(A,{mode:"wait",children:e.jsx(x.div,{initial:{scale:.8,opacity:0,rotate:-20},animate:{scale:1,opacity:1,rotate:0},exit:{scale:.8,opacity:0,rotate:20},transition:{type:"spring",stiffness:200,damping:15},className:"mb-3 flex h-16 w-16 items-center justify-center rounded-full bg-white/20 backdrop-blur-md ring-4 ring-white/10 shadow-lg",children:e.jsx(d.Icon,{className:"h-8 w-8 text-white"})},t.status)}),e.jsx(A,{mode:"wait",children:e.jsxs(x.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.3},children:[e.jsx("h2",{className:"font-display text-2xl font-bold tracking-tight",children:d.text}),e.jsx("p",{className:"mt-1 text-white/90 font-medium text-base",children:d.subtext})]},`${t.status}-text`)}),e.jsxs("div",{className:"mt-3 inline-flex items-center rounded-full bg-white/20 px-3 py-1 text-xs font-medium text-white backdrop-blur-md border border-white/10",children:["Order #",t.orderNumber]})]})]}),e.jsx("div",{className:"px-6 py-5 bg-white",children:e.jsxs("div",{className:"relative flex justify-between items-center",children:[e.jsx("div",{className:"absolute left-[20px] right-[20px] top-[16px] h-1 -translate-y-1/2 bg-gray-100 rounded-full z-0"}),e.jsx(x.div,{className:`absolute left-[20px] top-[16px] h-1 -translate-y-1/2 rounded-full z-0 bg-gradient-to-r ${d.headerGradient}`,initial:{width:"0%"},animate:{width:d.step===1?"0%":d.step===2?"50%":"calc(100% - 40px)"},transition:{duration:.5,ease:"easeInOut"}}),["waiting","preparing","ready"].map((a,i)=>{const m=i+1,f=d.step>=m,E=d.step===m;let D=B;return a==="preparing"&&(D=k),a==="ready"&&(D=F),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(x.div,{animate:{scale:E?1.2:1,backgroundColor:"#fff",borderColor:f?"currentColor":"#E5E7EB",boxShadow:E?"0 10px 15px -3px rgba(0, 0, 0, 0.1)":"none"},transition:{duration:.3},className:`flex h-8 w-8 items-center justify-center rounded-full border-2 transition-colors duration-300 ${f?d.color.replace("text-","border-"):"border-gray-200 text-gray-300"}`,children:e.jsx(D,{className:`h-4 w-4 ${f?d.color:"text-gray-300"}`})}),e.jsx("span",{className:`mt-2 text-[10px] font-bold uppercase tracking-wider transition-colors duration-300 ${f?d.color:"text-gray-400"}`,children:a})]},a)})]})}),e.jsxs("div",{className:"border-t border-gray-100 bg-gray-50/50 px-6 py-5",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Estimated Wait"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-0.5",children:["~",t.estimatedTime," min"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Total Amount"}),e.jsxs("p",{className:"text-lg font-bold text-primary-600 mt-0.5",children:["â‚±",t.totalAmount.toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>h(!n),className:"flex w-full items-center justify-between rounded-xl bg-white px-4 py-3 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-gray-100 transition-all hover:bg-gray-50 hover:shadow-md",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-semibold",children:["View Order Items (",t.orderItems.length,")"]})]}),e.jsx(le,{className:`h-4 w-4 text-gray-400 transition-transform duration-300 ${n?"rotate-180":""}`})]}),e.jsx(A,{children:n&&e.jsxs(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden rounded-xl bg-white shadow-sm ring-1 ring-gray-100",children:[e.jsx("ul",{className:"divide-y divide-gray-50 px-5",children:t.orderItems.map((a,i)=>e.jsxs("li",{className:"flex justify-between py-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-gray-900 block",children:a.productName}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["Qty: ",a.quantity]})]}),e.jsxs("span",{className:"font-bold text-gray-600",children:["â‚±",(a.price*a.quantity).toFixed(2)]})]},i))}),e.jsx("div",{className:"p-3 border-t border-gray-50 bg-gray-50/50",children:e.jsxs(y,{size:"sm",variant:"ghost",className:"w-full text-xs font-semibold text-primary-600 hover:bg-primary-50",onClick:()=>g(!0),children:[e.jsx(H,{className:"mr-2 h-3 w-3"}),"View Digital Receipt"]})})]})}),e.jsxs("div",{className:"pt-1 space-y-2",children:[t.status==="ready"?e.jsx(y,{variant:"primary",className:"w-full rounded-xl bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-green-600/30 transition-all py-3.5 text-base font-bold",onClick:b,disabled:w,children:w?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Updating..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"I've Received My Order"]})}):e.jsxs(y,{variant:"primary",className:"w-full rounded-xl bg-coffee-600 text-white hover:bg-coffee-700 shadow-lg hover:shadow-coffee-600/30 transition-all py-3.5 font-bold",onClick:I,children:[e.jsx(ge,{className:"mr-2 h-5 w-5"}),"Browse Menu"]}),e.jsxs(y,{variant:"ghost",className:"w-full rounded-xl text-gray-500 hover:bg-gray-100 font-semibold py-2.5",onClick:()=>u("/menu"),children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Back to Menu"]})]})]})]})]})]},"active-modal")}),e.jsx(W,{order:t,isOpen:N,onClose:()=>g(!1)})]}),document.body)},Ce="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQ2IiBoZWlnaHQ9IjE3OCIgdmlld0JveD0iMCAwIDI0NiAxNzgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xNTQuNTAzIDgwQzE4MC41MDMgNTEgMjEzLjAwMyAyMC41IDIyNS41MDMgMTguNUMyMzguMDAzIDE2LjUgMjQ0LjAwMyAyOS41IDI0NC4wMDMgMjkuNUMyNDQuMDAzIDI5LjUgMjQ4LjUwMyA1Mi41IDI0MC41MDMgODBDMjMyLjUwMyAxMDcuNSAyMTEuNTAzIDEyNCAyMTEuNTAzIDEyNEMyMTEuNTAzIDEyNCAxNjYuNTAzIDE3MSAxNDcuMDAzIDE3NUMxNDcuMDAzIDE3NSAxMTkuMDAzIDE4MS41IDEwNy4wMDMgMTcyLjVDOTUuMDAyNSAxNjMuNSAxMjguNTAzIDEwOSAxNTQuNTAzIDgwWiIgZmlsbD0iI0VCNUYxNiIvPgo8cGF0aCBkPSJNMTIuMDAyNSA4OUMxMi4wMDI1IDg5IC0yMS4wMjkzIDIyLjAyMyAyMi41MDI1IDE3QzM1LjUwMjUgMTUuNSA4MC4wMDI1IDU2IDc5LjUwMjUgNTkuNUM4Mi41MDI1IDc1IDcyLjAwMjUgODcgNjQuNTAyNSA5N0M2MS4xMzM2IDEwMS40OTIgNjAuMDAyNSAxMDcuNSA1OC4wMDI1IDExOS41QzU4LjAwMjUgMTM5IDUzLjAwMjUgMTM4LjUgNTMuMDAyNSAxMzguNUM1My4wMDI1IDEzOC41IDQwLjUwMjUgMTQxIDEyLjAwMjUgODlaIiBmaWxsPSIjRUI1RjE2IiIvPgo8cGF0aCBkPSJNNDcuMDAyNSAxN0M0MS4wMDI1IDEyLjAwMDEgNDIuMDAyNSAtNy42MjkzOWUtMDYgNTMuMDAyNSAwQzY0LjAwMjUgNy42Mjk0ZS0wNiA3NC4xOTA0IDQuNzY1MzQgODcuMDAyNSAxMEMxMDAuMzQ3IDE1LjQ1MjEgMTEwLjkxMSAxOSAxMTQuNTAzIDI2LjVDMTE4LjA5NCAzNCAxMTQuNTAzIDM5LjUgMTEwLjAwMyA0NUMxMDUuNTAzIDUwLjUgMTAyLjAwMyA1MiA5NC41MDI1IDUxQzg3LjAwMjUgNTAgNTMuMDAyNSAyMiA0Ny4wMDI1IDE3WiIgZmlsbD0iI0VCNUYxNiIvPgo8cGF0aCBkPSJNMjA1LjUwMyAyMy41QzIxOC41MDMgMTQgMjA1LjUwMyA1LjUgMjA1LjUwMyA1LjVDMTYyLjIzOSAxLjQzMjUyIDEyMi40MDggMzEuOTMyNCA4Mi4wMDI1IDg4LjVDNzEuNjQ1NCAxMDMgNjIuNTU4MyAxNTAuMzIyIDc4LjUwMjUgMTYxQzk3LjE3ODQgMTczLjUwOCAxMDIuNjM0IDE2Ny4xMDkgMTAzLjUwMyAxMzJDMTIxLjUwMyA1MSAxOTIuNTAzIDMzIDIwNS41MDMgMjMuNVoiIGZpbGw9IiNFQjVGMTYiLz4KPC9zdmc+Cg==";let J=null;const Se=async()=>{if(console.log("[Notifications] ðŸ” Checking notification support..."),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported in this browser"),"denied";console.log("[Notifications] âœ… Notification API available"),console.log("[Notifications] Current permission:",Notification.permission);try{console.log("[Notifications] ðŸ“ Requesting notification permission...");const t=await Notification.requestPermission();return console.log("[Notifications] Permission result:",t),t}catch(t){return console.error("[Notifications] âŒ Error requesting notification permission:",t),"denied"}},ze=async t=>{if(console.log("[Notifications] ðŸ”” Attempting to show notification:",t.title),!("Notification"in window))return console.warn("[Notifications] âŒ Notifications are not supported"),!1;if(console.log("[Notifications] Current permission:",Notification.permission),Notification.permission!=="granted")return console.warn("[Notifications] âŒ Notification permission not granted. Current:",Notification.permission),!1;const r={body:t.body,icon:t.icon,tag:t.tag,badge:t.icon,vibrate:[200,100,200],requireInteraction:!1,data:t.data};console.log("[Notifications] Notification options:",r);try{if(J&&"showNotification"in J,"Notification"in window&&typeof Notification=="function"){console.log("[Notifications] ðŸ’» Using direct Notification API (fallback)");const n=new Notification(t.title,r);return n.onclick=()=>{console.log("[Notifications] ðŸ‘† Notification clicked"),window.focus(),n.close()},console.log("[Notifications] âœ… Direct notification shown successfully!"),!0}return console.warn("[Notifications] âŒ No notification method available"),!1}catch(n){return console.error("[Notifications] âŒ Error showing notification:",n),!1}},Te=()=>{if(!("Notification"in window))return"denied";const t=Notification.permission;return console.log("[Notifications] Current permission status:",t),t},Z=()=>{const t="Notification"in window;return console.log("[Notifications] Notifications supported:",t),t},P=()=>e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-md border border-gray-100 text-center animate-pulse",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 mb-3"}),e.jsx("div",{className:"h-8 w-16 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"})]})}),He=()=>{var G;const{currentUser:t}=ce(),{activeOrder:r,orderHistory:n}=de(),{products:h,isLoading:l}=me(),{addToCart:p,showToast:w}=se(),C=xe(),S=ee(),[v,z]=o.useState("default"),[T,N]=o.useState(!1),g=o.useRef(null),[u,d]=o.useState(null),[M,I]=o.useState(!1),[b,a]=o.useState(()=>{const s=localStorage.getItem("dismissedOrderIds");return s?JSON.parse(s):[]});o.useEffect(()=>{localStorage.setItem("dismissedOrderIds",JSON.stringify(b))},[b]);const i=o.useMemo(()=>{const s=n.find(c=>c.status==="completed"&&!b.includes(c.id));return s||r||null},[r,n,b]),m=o.useMemo(()=>{const s=h.length>0?h:ue;return s.length>0?s[0]:null},[h]),[f,E]=o.useState(((G=C.state)==null?void 0:G.fromCheckout)||!1);o.useEffect(()=>{if(f){const s=setTimeout(()=>{E(!1),window.history.replaceState({},document.title)},2e3);return()=>clearTimeout(s)}},[f]),o.useEffect(()=>{if(Z()){const s=Te();z(s),s==="default"&&N(!0)}},[]),o.useEffect(()=>{r&&r.status==="ready"&&v==="granted"&&g.current!==r.id&&ze({title:"Your Order is Ready! â˜•",body:`Your Rush Coffee order (${r.orderNumber}) is now ready for pickup.`,icon:Ce,tag:r.id,data:{orderId:r.id,orderNumber:r.orderNumber}}).then(s=>{s&&(console.log("Notification sent successfully"),g.current=r.id)}),(!r||r.status==="completed")&&(g.current=null)},[r,v]);const D=async()=>{if(!Z()){alert("This browser does not support notifications");return}const s=await Se();z(s),(s==="granted"||s==="denied")&&N(!1)},ae=()=>{if(i){const s=[...b,i.id];a(s),localStorage.setItem("dismissedOrderIds",JSON.stringify(s))}},re=s=>{d(s),I(!0)},ie=(s,c)=>{if(u){const j=u.sizes[0];p(u,j,s,c),w(`Added ${c} ${u.name} to cart`),I(!1)}},L=o.useMemo(()=>n.filter(s=>s.status==="completed").slice(0,2),[n]),oe=s=>{const c=h.find(j=>j.id===s);return(c==null?void 0:c.imageUrl)||null};return t?e.jsxs("div",{className:"flex min-h-screen flex-col bg-gradient-to-br from-coffee-50 via-gray-50 to-primary-50 relative",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-10 left-10 h-32 w-32 rounded-full bg-coffee-600 blur-3xl opacity-5"}),e.jsx("div",{className:"absolute bottom-20 right-10 h-40 w-40 rounded-full bg-primary-600 blur-3xl opacity-5"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-64 w-64 rounded-full bg-coffee-400 blur-3xl opacity-5"})]}),e.jsx(V,{}),e.jsxs("main",{className:"flex-1 w-full max-w-3xl mx-auto px-4 py-8 sm:py-12 relative z-10",children:[i&&e.jsx(ke,{order:i,onDismiss:ae}),f&&!i&&e.jsx("div",{className:"fixed top-24 left-1/2 -translate-x-1/2 z-50 w-full max-w-md px-4",children:e.jsxs("div",{className:"w-full rounded-2xl bg-gradient-to-r from-green-50 to-emerald-50 p-4 text-center border border-green-200 shadow-lg animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx("svg",{className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"font-bold text-green-900",children:"Order Placed Successfully!"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"You are now in the queue."})]})}),T&&v==="default"&&(!i||i.status==="completed")&&e.jsxs("div",{className:"mb-8 relative w-full animate-fade-in-up rounded-2xl border border-primary-200 bg-white/95 backdrop-blur-sm p-4 shadow-md",children:[e.jsx("button",{onClick:()=>N(!1),className:"absolute top-2 right-2 rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600","aria-label":"Dismiss",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-primary-100 to-primary-200",children:e.jsx(F,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Get Order Updates"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Know the moment your coffee is ready!"})]})]}),e.jsx("button",{onClick:D,className:"mt-4 w-full rounded-full bg-gradient-to-r from-primary-600 to-primary-700 px-4 py-2.5 text-sm font-semibold text-white transition-all hover:shadow-lg",children:"Enable Notifications"})]}),e.jsxs("div",{className:"text-center mb-8 sm:mb-12",children:[e.jsx("h1",{className:"font-display text-2xl sm:text-3xl font-bold text-coffee-900",children:"Your Queue"}),e.jsx("p",{className:"mt-2 text-sm sm:text-base text-gray-600",children:"Track your orders and rewards"})]}),t&&e.jsxs("div",{className:"mb-8 sm:mb-12",children:[e.jsx("h2",{className:"text-center text-xs font-bold text-gray-500 uppercase tracking-wider mb-6",children:"Your Coffee Journey"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 sm:gap-6",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 sm:p-6 shadow-md border border-gray-100 hover:shadow-lg transition-shadow text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center mb-2 sm:mb-3",children:e.jsx(B,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600"})}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-coffee-900",children:t.totalOrders||0}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 font-medium",children:"Orders"})]})}),e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 sm:p-6 shadow-md border border-gray-100 hover:shadow-lg transition-shadow text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center mb-2 sm:mb-3",children:e.jsx(be,{className:"h-5 w-5 sm:h-6 sm:w-6 text-amber-600"})}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-coffee-900",children:t.currentPoints||0}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 font-medium",children:"Points"})]})}),e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 sm:p-6 shadow-md border border-gray-100 hover:shadow-lg transition-shadow text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center mb-2 sm:mb-3",children:e.jsx(Ne,{className:"h-5 w-5 sm:h-6 sm:w-6 text-green-600"})}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-coffee-900 capitalize",children:t.tier||"Bronze"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 font-medium",children:"Tier"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsx(P,{}),e.jsx(P,{})]})})]}),L.length>0&&e.jsxs("div",{className:"w-full mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-center flex-1 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Recent Orders"}),n.filter(s=>s.status==="completed").length>2&&e.jsx(U,{to:"/profile",className:"text-xs font-semibold text-primary-600 hover:text-primary-700 transition-colors",children:"View All"})]}),e.jsx("div",{className:"space-y-4",children:L.map(s=>{const c=s.orderItems[0],j=c?oe(c.productId):null;return e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 sm:p-5 shadow-md border border-gray-100 hover:shadow-xl hover:scale-[1.01] transition-all duration-200 cursor-pointer group",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 h-14 w-14 sm:h-16 sm:w-16 rounded-xl overflow-hidden bg-gradient-to-br from-coffee-100 to-coffee-200 shadow-inner group-hover:shadow-lg transition-shadow",children:j?e.jsx("img",{src:j,alt:c.productName,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsx(k,{className:"h-7 w-7 sm:h-8 sm:w-8 text-coffee-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h3",{className:"font-bold text-coffee-900 text-sm sm:text-base truncate pr-2 sm:pr-4",children:(c==null?void 0:c.productName)||"Coffee Order"}),e.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0 font-medium bg-gray-100 px-2 py-1 rounded-full",children:new Date(s.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-2 font-mono",children:s.orderNumber}),s.orderItems.length>1&&e.jsxs("p",{className:"text-xs text-gray-600 mb-2 sm:mb-3 italic",children:["+",s.orderItems.length-1," more item",s.orderItems.length>2?"s":""]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:"Completed"}),e.jsxs("p",{className:"text-sm sm:text-base font-bold text-primary-600",children:["â‚±",s.totalAmount.toFixed(2)]})]})]})]})},s.id)})})]}),e.jsx("div",{className:"w-full max-w-md mx-auto mt-6",children:l?e.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-gray-100 text-center animate-pulse",children:[e.jsx("div",{className:"mb-4 relative mx-auto w-32 h-32 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-4"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded"})]}):m?e.jsxs(e.Fragment,{children:[L.length>0?e.jsx("h2",{className:"text-center text-xs font-bold text-gray-500 uppercase tracking-wider mb-6",children:"Recommended for You"}):e.jsxs("div",{className:"text-center mb-6 animate-fade-in-up",children:[e.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-2",children:[e.jsx($,{className:"h-5 w-5 text-amber-500"}),e.jsx("h2",{className:"text-lg font-bold text-coffee-900",children:"Welcome to Rush Coffee!"}),e.jsx($,{className:"h-5 w-5 text-amber-500"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Start your journey with our most popular drink:"})]}),e.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl p-5 sm:p-6 shadow-xl border border-gray-100 text-center relative overflow-hidden group hover:shadow-2xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-4 right-4 bg-amber-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10 animate-pulse",children:"Recommended"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-50/50 to-transparent pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"mb-4 relative mx-auto w-28 h-28 sm:w-32 sm:h-32",children:[e.jsx("div",{className:"absolute inset-0 bg-primary-200 rounded-full blur-2xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"}),e.jsx("img",{src:m.imageUrl,alt:m.name,className:"w-full h-full object-cover rounded-full shadow-lg group-hover:scale-110 transition-transform duration-500"})]}),e.jsx("h3",{className:"text-lg sm:text-xl font-display font-bold text-gray-900 mb-1",children:m.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mb-4 line-clamp-2 px-2 sm:px-4",children:m.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[e.jsxs("button",{onClick:()=>re(m),className:"w-full sm:flex-1 bg-primary-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-primary-600/20 hover:bg-primary-700 hover:shadow-primary-600/40 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Add to Cart"]}),e.jsx("button",{onClick:()=>S("/menu"),className:"w-full sm:w-auto bg-white text-gray-700 font-bold py-3 px-4 rounded-xl border border-gray-200 hover:bg-gray-50 hover:border-gray-300 hover:shadow-md transition-all",children:"View Menu"})]})]})]})]}):L.length===0&&e.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-8 border-2 border-dashed border-gray-200 text-center",children:[e.jsx(k,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet. Your coffee journey starts here! â˜•"}),e.jsx("button",{onClick:()=>S("/menu"),className:"mt-6 inline-flex items-center justify-center gap-2 rounded-full bg-primary-600 px-6 py-2.5 font-semibold text-white shadow-md transition-all hover:bg-primary-700",children:"Start a New Order"})]})})]}),u&&e.jsx(ye,{product:u,selectedSize:u.sizes[0],isOpen:M,onClose:()=>I(!1),onConfirm:ie}),e.jsx(q,{})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-gradient-to-br from-coffee-50 via-gray-50 to-primary-50 relative",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-10 left-10 h-32 w-32 rounded-full bg-coffee-600 blur-3xl opacity-5"}),e.jsx("div",{className:"absolute bottom-20 right-10 h-40 w-40 rounded-full bg-primary-600 blur-3xl opacity-5"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-64 w-64 rounded-full bg-coffee-400 blur-3xl opacity-5"})]}),e.jsx(V,{}),e.jsx("main",{className:"flex flex-1 items-center justify-center px-6 py-20 text-center relative z-10",children:e.jsxs("div",{children:[e.jsx(K,{className:"mx-auto h-24 w-24 text-gray-300 opacity-50"}),e.jsx("h1",{className:"mt-4 font-display text-2xl font-bold text-coffee-900",children:"You're not in the queue"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Please log in and place an order to see your queue status."}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[e.jsx(U,{to:"/auth/login",className:"rounded-full bg-primary-600 px-8 py-3 font-semibold text-white transition-transform hover:scale-105 shadow-lg",children:"Login"}),e.jsx(U,{to:"/menu",className:"rounded-full border-2 border-primary-600 px-8 py-3 font-semibold text-primary-600 transition-transform hover:scale-105 hover:bg-primary-50 shadow-sm",children:"View Menu"})]})]})}),e.jsx(q,{})]})};export{He as default};
