import{c as C,r as m,j as e,Q as X,l as Y,n as de,u as me,a7 as he,V as ue,K as pe,a6 as E,Y as U,d as f,a8 as xe,i as ge,y as ye}from"./index-6FamDUS3.js";import{S as ee}from"./save-CNQc-RA4.js";import{B as J}from"./Button-B_H7Xy4P.js";import{C as fe}from"./calendar-Zh7iaO3E.js";import{P as Q}from"./package-BUfghy3a.js";import{S as H}from"./sparkles-ibwi-YCM.js";import{S as be}from"./search-B8VLq3ua.js";import{S as we,A as ke,L as Se}from"./snowflake-5NYkuAwe.js";import{C as je}from"./coffee-JPsQqpeo.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M17 11h1a3 3 0 0 1 0 6h-1",key:"1yp76v"}],["path",{d:"M9 12v6",key:"1u1cab"}],["path",{d:"M13 12v6",key:"1sugkk"}],["path",{d:"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z",key:"1510fo"}],["path",{d:"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8",key:"19jb7n"}]],Ne=C("beer",ve);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],De=C("box",Ce);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],Z=C("droplet",Te);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M15.4 15.63a7.875 6 135 1 1 6.23-6.23 4.5 3.43 135 0 0-6.23 6.23",key:"1dtqwm"}],["path",{d:"m8.29 12.71-2.6 2.6a2.5 2.5 0 1 0-1.65 4.65A2.5 2.5 0 1 0 8.7 18.3l2.59-2.59",key:"1oq1fw"}]],Ae=C("drumstick",Ie);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]],Me=C("milk",Pe);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M12 3v6",key:"1holv5"}],["path",{d:"M16.76 3a2 2 0 0 1 1.8 1.1l2.23 4.479a2 2 0 0 1 .21.891V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9.472a2 2 0 0 1 .211-.894L5.45 4.1A2 2 0 0 1 7.24 3z",key:"187q7i"}],["path",{d:"M3.054 9.013h17.893",key:"grwhos"}]],ze=C("package-2",Fe),Be=({ingredient:r,onClose:b,onUpdate:D})=>{const[a,k]=m.useState("add"),[h,S]=m.useState(""),[u,j]=m.useState(r.expirationDate||""),x=l=>{l.preventDefault(),typeof h=="number"&&h>=0&&D(r.id,h,a,u)};return e.jsxs(X,{isOpen:!0,onClose:b,title:`Update Stock: ${r.name}`,size:"md",children:[e.jsxs("div",{className:"text-sm mb-4",children:[e.jsxs("p",{children:["Current Stock: ",e.jsxs("span",{className:"font-bold",children:[r.stock.toLocaleString()," ",r.unit]})]}),r.expirationDate&&e.jsxs("p",{className:"mt-1 text-gray-500",children:["Current Expiration: ",new Date(r.expirationDate).toLocaleDateString()]})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 rounded-full bg-gray-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>k("add"),className:`w-full rounded-full py-2 text-sm font-semibold transition-colors ${a==="add"?"bg-primary-600 text-white shadow":"text-gray-600 hover:bg-primary-50"}`,children:"Add Stock"}),e.jsx("button",{type:"button",onClick:()=>k("set"),className:`w-full rounded-full py-2 text-sm font-semibold transition-colors ${a==="set"?"bg-primary-600 text-white shadow":"text-gray-600 hover:bg-primary-50"}`,children:"Set New Total"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:a==="add"?`Amount to Add (${r.unit})`:`New Total Stock (${r.unit})`}),e.jsx("input",{type:"number",id:"amount",value:h,onChange:l=>S(l.target.value===""?"":Number(l.target.value)),min:"0",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expirationDate",className:"block text-sm font-medium text-gray-700",children:"New Expiration Date (Optional)"}),e.jsx("input",{type:"date",id:"expirationDate",value:u,onChange:l=>j(l.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Update this if the new batch has a different expiration date."})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:b,className:"rounded-full bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded-full bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-700 disabled:bg-primary-400",disabled:h===""||h<0,children:[e.jsx(ee,{className:"h-4 w-4"}),"Update Stock"]})]})]})]})},$e=({isOpen:r,onClose:b,onAdd:D})=>{const[a,k]=m.useState({name:"",category:"Coffee & Beans",stock:0,unit:"g",lowStockThreshold:10}),[h,S]=m.useState(!1),u=x=>{const{name:l,value:T,type:v}=x.target;k(M=>({...M,[l]:v==="number"?Math.max(0,Number(T)):T}))},j=async x=>{if(x.preventDefault(),!!a.name.trim()){S(!0);try{await D(a)}catch(l){console.error("Failed to add ingredient",l)}finally{S(!1)}}};return e.jsx(X,{isOpen:r,onClose:b,title:"Add New Ingredient",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Ingredient Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsxs("select",{id:"category",name:"category",value:a.category,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,children:[e.jsx("option",{value:"Coffee & Beans",children:"Coffee & Beans"}),e.jsx("option",{value:"Dairy",children:"Dairy"}),e.jsx("option",{value:"Sauces",children:"Sauces"}),e.jsx("option",{value:"Syrups",children:"Syrups"}),e.jsx("option",{value:"Specialty",children:"Specialty"}),e.jsx("option",{value:"Matcha & Tea",children:"Matcha & Tea"}),e.jsx("option",{value:"Fruits & Purees",children:"Fruits & Purees"}),e.jsx("option",{value:"Beverages",children:"Beverages"}),e.jsx("option",{value:"Frozen",children:"Frozen"}),e.jsx("option",{value:"Proteins",children:"Proteins"}),e.jsx("option",{value:"Dry Goods",children:"Dry Goods"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700",children:"Initial Stock"}),e.jsx("input",{type:"number",id:"stock",name:"stock",value:a.stock,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),e.jsxs("select",{id:"unit",name:"unit",value:a.unit,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{value:"g",children:"Grams (g)"}),e.jsx("option",{value:"ml",children:"Milliliters (ml)"}),e.jsx("option",{value:"pcs",children:"Pieces (pcs)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lowStockThreshold",className:"block text-sm font-medium text-gray-700",children:"Low Stock Threshold"}),e.jsx("input",{type:"number",id:"lowStockThreshold",name:"lowStockThreshold",value:a.lowStockThreshold,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expirationDate",className:"block text-sm font-medium text-gray-700",children:"Expiration Date"}),e.jsx("input",{type:"date",id:"expirationDate",name:"expirationDate",value:a.expirationDate||"",onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(J,{type:"button",variant:"ghost",onClick:b,children:"Cancel"}),e.jsxs(J,{type:"submit",disabled:h,children:[h?e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Save Ingredient"]})]})]})})},K=[{id:"espresso-shot",name:"Espresso Shot",category:"Coffee & Beans",stock:1e3,unit:"pcs",lowStockThreshold:100},{id:"coffee-beans",name:"Coffee Beans (Blend)",category:"Coffee & Beans",stock:1e4,unit:"g",lowStockThreshold:1e3},{id:"milk",name:"Milk",category:"Dairy",stock:2e4,unit:"ml",lowStockThreshold:2e3},{id:"condensed-milk",name:"Condensed Milk",category:"Dairy",stock:5e3,unit:"ml",lowStockThreshold:500},{id:"cream-cheese",name:"Cream Cheese",category:"Dairy",stock:3e3,unit:"g",lowStockThreshold:300},{id:"whipped-cream",name:"Whipped Cream",category:"Dairy",stock:2e3,unit:"ml",lowStockThreshold:200},{id:"chocolate-sauce",name:"Chocolate Sauce",category:"Sauces",stock:3e3,unit:"ml",lowStockThreshold:300},{id:"caramel-sauce",name:"Caramel Sauce",category:"Sauces",stock:3e3,unit:"ml",lowStockThreshold:300},{id:"brown-sugar-syrup",name:"Brown Sugar Syrup",category:"Syrups",stock:2500,unit:"ml",lowStockThreshold:250,portionSize:20},{id:"vanilla-syrup",name:"Vanilla Syrup",category:"Syrups",stock:2e3,unit:"ml",lowStockThreshold:200},{id:"orange-syrup",name:"Orange Syrup",category:"Syrups",stock:1500,unit:"ml",lowStockThreshold:150},{id:"biscoff-spread",name:"Biscoff Spread",category:"Specialty",stock:2e3,unit:"g",lowStockThreshold:200},{id:"peanut-butter",name:"Peanut Butter",category:"Specialty",stock:2e3,unit:"g",lowStockThreshold:200},{id:"oreo-crumbs",name:"Oreo Cookie Crumbs",category:"Specialty",stock:3e3,unit:"g",lowStockThreshold:300},{id:"coffee-jelly",name:"Coffee Jelly",category:"Specialty",stock:2500,unit:"g",lowStockThreshold:250},{id:"red-velvet-powder",name:"Red Velvet Powder",category:"Specialty",stock:2e3,unit:"g",lowStockThreshold:200},{id:"pearls",name:"Pearls",category:"Specialty",stock:3e3,unit:"g",lowStockThreshold:300,isTopping:!0,toppingPrice:10,portionSize:30},{id:"pudding",name:"Pudding",category:"Specialty",stock:2e3,unit:"g",lowStockThreshold:200,isTopping:!0,toppingPrice:15,portionSize:40},{id:"grass-jelly",name:"Grass Jelly",category:"Specialty",stock:2500,unit:"g",lowStockThreshold:250,isTopping:!0,toppingPrice:15,portionSize:35},{id:"matcha-powder",name:"Matcha Powder",category:"Matcha & Tea",stock:2e3,unit:"g",lowStockThreshold:200},{id:"strawberry-puree",name:"Strawberry Puree",category:"Fruits & Purees",stock:4e3,unit:"ml",lowStockThreshold:400},{id:"mango-puree",name:"Mango Puree",category:"Fruits & Purees",stock:4e3,unit:"ml",lowStockThreshold:400},{id:"blueberry-puree",name:"Blueberry Puree",category:"Fruits & Purees",stock:3e3,unit:"ml",lowStockThreshold:300},{id:"green-apple-puree",name:"Green Apple Puree",category:"Fruits & Purees",stock:3e3,unit:"ml",lowStockThreshold:300},{id:"lemon-juice",name:"Lemon Juice",category:"Fruits & Purees",stock:2e3,unit:"ml",lowStockThreshold:200},{id:"lychee-syrup",name:"Lychee Syrup",category:"Syrups",stock:2e3,unit:"ml",lowStockThreshold:200},{id:"mixed-berries",name:"Mixed Berries",category:"Fruits & Purees",stock:2e3,unit:"g",lowStockThreshold:200},{id:"soda-water",name:"Soda Water",category:"Beverages",stock:1e4,unit:"ml",lowStockThreshold:1e3},{id:"ice-cubes",name:"Ice Cubes",category:"Frozen",stock:5e4,unit:"g",lowStockThreshold:5e3,portionSize:100},{id:"hot-water",name:"Hot Water",category:"Beverages",stock:99999,unit:"ml",lowStockThreshold:1e4},{id:"bacon-strips",name:"Bacon Strips",category:"Proteins",stock:5,unit:"kg",lowStockThreshold:1,portionSize:.1},{id:"porkchop",name:"Porkchop",category:"Proteins",stock:4,unit:"kg",lowStockThreshold:1,portionSize:.2},{id:"chicken-fillet",name:"Chicken Fillet",category:"Proteins",stock:5,unit:"kg",lowStockThreshold:1,portionSize:.15},{id:"bread-crumbs",name:"Bread Crumbs",category:"Dry Goods",stock:3e3,unit:"g",lowStockThreshold:300},{id:"french-fries",name:"French Fries",category:"Frozen",stock:6,unit:"kg",lowStockThreshold:1,portionSize:.15},{id:"white-sauce",name:"White Sauce",category:"Sauces",stock:2e3,unit:"ml",lowStockThreshold:200},{id:"cooking-oil",name:"Cooking Oil",category:"Dry Goods",stock:5e3,unit:"ml",lowStockThreshold:500,expirationDate:"2025-12-31"},{id:"cup-grande",name:"Cup - Grande (16oz)",category:"Supplies & Packaging",stock:500,unit:"pcs",lowStockThreshold:50,portionSize:1},{id:"cup-venti",name:"Cup - Venti (20oz)",category:"Supplies & Packaging",stock:500,unit:"pcs",lowStockThreshold:50,portionSize:1},{id:"lid-grande",name:"Lid - Grande",category:"Supplies & Packaging",stock:500,unit:"pcs",lowStockThreshold:50,portionSize:1},{id:"lid-venti",name:"Lid - Venti",category:"Supplies & Packaging",stock:500,unit:"pcs",lowStockThreshold:50,portionSize:1},{id:"straw",name:"Straws",category:"Supplies & Packaging",stock:1e3,unit:"pcs",lowStockThreshold:100,portionSize:1},{id:"napkins",name:"Napkins",category:"Supplies & Packaging",stock:2e3,unit:"pcs",lowStockThreshold:200,portionSize:2},{id:"takeout-pack",name:"Takeout Pack (Meal Box)",category:"Supplies & Packaging",stock:300,unit:"pcs",lowStockThreshold:30,portionSize:1}],We=()=>{const[r,b]=m.useState([]),[D,a]=m.useState(!0),[k,h]=m.useState(!1),[S,u]=m.useState(!1),[j,x]=m.useState(null),[l,T]=m.useState("All"),[v,M]=m.useState(""),[g,q]=m.useState("all"),{showToast:I}=de(),{currentUser:F}=me(),te=(F==null?void 0:F.role)==="admin",se={All:{icon:Q,color:"text-gray-700",bgColor:"bg-gray-100"},"Coffee & Beans":{icon:je,color:"text-amber-700",bgColor:"bg-amber-50"},Dairy:{icon:Me,color:"text-blue-700",bgColor:"bg-blue-50"},Sauces:{icon:Z,color:"text-red-700",bgColor:"bg-red-50"},Syrups:{icon:Z,color:"text-purple-700",bgColor:"bg-purple-50"},Specialty:{icon:H,color:"text-yellow-700",bgColor:"bg-yellow-50"},"Matcha & Tea":{icon:Se,color:"text-green-700",bgColor:"bg-green-50"},"Fruits & Purees":{icon:ke,color:"text-pink-700",bgColor:"bg-pink-50"},Beverages:{icon:Ne,color:"text-cyan-700",bgColor:"bg-cyan-50"},Frozen:{icon:we,color:"text-blue-600",bgColor:"bg-blue-50"},Proteins:{icon:Ae,color:"text-orange-700",bgColor:"bg-orange-50"},"Dry Goods":{icon:De,color:"text-stone-700",bgColor:"bg-stone-50"},"Supplies & Packaging":{icon:ze,color:"text-indigo-700",bgColor:"bg-indigo-50"}},z=he.useMemo(()=>{let t=r;if(l!=="All"&&(t=t.filter(s=>s.category===l)),g==="lowStock")t=t.filter(s=>s.stock>0&&s.stock<=s.lowStockThreshold);else if(g==="outOfStock")t=t.filter(s=>s.stock===0);else if(g==="newAdded"){const s=new Date;s.setDate(s.getDate()-7),t=t.filter(o=>o.createdAt&&new Date(o.createdAt)>=s)}return v.trim()&&(t=t.filter(s=>s.name.toLowerCase().includes(v.toLowerCase()))),t},[r,l,v,g]),oe=["All","Coffee & Beans","Dairy","Sauces","Syrups","Specialty","Matcha & Tea","Fruits & Purees","Beverages","Frozen","Proteins","Dry Goods","Supplies & Packaging"],re=t=>t==="All"?r.length:r.filter(s=>s.category===t).length,V=t=>(t==="All"?r:r.filter(o=>o.category===t)).filter(o=>o.stock>0&&o.stock<=o.lowStockThreshold).length,P=t=>{q(t),T("All")},_=t=>t.stock===0?{text:"Out of Stock",color:"text-red-600",Icon:E}:t.stock<=t.lowStockThreshold?{text:"Low Stock",color:"text-yellow-600",Icon:U}:{text:"In Stock",color:"text-green-600",Icon:ge},B=r.filter(t=>{if(!t.expirationDate)return!1;const s=new Date,d=new Date(t.expirationDate).getTime()-s.getTime();return Math.ceil(d/(1e3*60*60*24))<=7}),$=r.filter(t=>t.stock>0&&t.stock<=t.lowStockThreshold),L=r.filter(t=>t.stock===0),ae=r.filter(t=>{if(!t.createdAt)return!1;const s=new Date(t.createdAt),o=new Date;return o.setDate(o.getDate()-7),s>=o});m.useEffect(()=>{const t=async()=>{const o=f.collection("ingredients"),d=await o.get(),c=new Set(d.docs.map(i=>i.id)),n=f.batch();let N=!1;K.forEach(i=>{if(!c.has(i.id)){console.log(`Seeding missing ingredient: ${i.name}`);const{id:y,...p}=i,A=o.doc(y);n.set(A,p),N=!0}}),d.docs.forEach(i=>{const y=i.data(),p={};if(!y.expirationDate){const A=new Date;A.setDate(A.getDate()+30),p.expirationDate=A.toISOString().split("T")[0]}y.createdAt||(p.createdAt=new Date().toISOString()),Object.keys(p).length>0&&(n.update(i.ref,p),N=!0)}),N&&(await n.commit(),console.log("Ingredients seeded/updated successfully."));try{await xe()}catch(i){console.error("Error seeding customization options:",i)}return f.collection("ingredients").orderBy("name","asc").onSnapshot(i=>{const y=[];i.forEach(p=>{y.push({id:p.id,...p.data()})}),console.log("ðŸ“¦ Fetched Ingredients:",y.map(p=>`${p.name} (${p.id})`)),b(y),a(!1)},i=>{console.error("Error fetching inventory: ",i),a(!1)})};let s;return t().then(o=>{o&&(s=o)}),()=>{s&&s()}},[]);const O=t=>{x(t),h(!0)},G=()=>{h(!1),x(null)},ne=()=>{u(!0)},R=()=>{u(!1)},ie=async t=>{try{const s=t.name.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();if((await f.collection("ingredients").doc(s).get()).exists){I(`Ingredient with name "${t.name}" already exists!`);return}const{id:d,...c}=t,n={...c,createdAt:new Date().toISOString()};await f.collection("ingredients").doc(s).set(n),I(`Ingredient "${t.name}" added successfully with ID: ${s}`),R()}catch(s){throw console.error("Error adding ingredient: ",s),I("Failed to add ingredient."),s}},le=async(t,s,o,d)=>{const c=f.collection("ingredients").doc(t);try{const n={};o==="add"?n.stock=ye.firestore.FieldValue.increment(s):n.stock=s,d&&(n.expirationDate=d),await c.update(n),G()}catch(n){console.error("Error updating stock: ",n)}},ce=async()=>{try{a(!0);const t=f.batch(),s=f.collection("ingredients"),o=await s.get(),d=new Map;o.docs.forEach(c=>{d.set(c.id,c.data())}),K.forEach(c=>{const{id:n,...N}=c,W=s.doc(n),w=d.get(n),i={...N,expirationDate:(w==null?void 0:w.expirationDate)||N.expirationDate,createdAt:(w==null?void 0:w.createdAt)||new Date().toISOString()};t.set(W,i)}),await t.commit(),I("Ingredients re-seeded successfully!"),console.log("Ingredients re-seeded from mockIngredients.ts")}catch(t){console.error("Error re-seeding ingredients: ",t),I("Failed to re-seed ingredients.")}finally{a(!1)}};return D?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Y,{className:"h-12 w-12 animate-spin text-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h1",{className:"font-display text-2xl font-bold text-gray-800 sm:text-3xl",children:"Inventory Management"}),te&&e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsxs("button",{onClick:ce,className:"flex w-full items-center justify-center gap-2 rounded-full bg-green-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-green-700 sm:w-auto",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{children:"Re-seed Ingredients"})]}),e.jsxs("button",{onClick:ne,className:"flex w-full items-center justify-center gap-2 rounded-full bg-primary-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-primary-700 sm:w-auto",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Ingredient"})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[L.length>0&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-2 text-red-600",children:e.jsx(E,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-red-900",children:["Critical: ",L.length," Items Out of Stock"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:L.map(t=>e.jsx("span",{className:"inline-flex items-center rounded-md bg-white px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/20",children:t.name},t.id))})]})]})}),$.length>0&&e.jsx("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-yellow-100 p-2 text-yellow-600",children:e.jsx(U,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-yellow-900",children:["Warning: ",$.length," Items Low on Stock"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:$.map(t=>e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white px-2 py-1 text-xs font-medium text-yellow-700 ring-1 ring-inset ring-yellow-600/20",children:[t.name," (",t.stock," ",t.unit,")"]},t.id))})]})]})}),B.length>0&&e.jsx("div",{className:"rounded-xl border border-orange-200 bg-orange-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-orange-100 p-2 text-orange-600",children:e.jsx(fe,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-orange-900",children:["Attention Needed: ",B.length," Items Expiring Soon"]}),e.jsx("p",{className:"mt-1 text-sm text-orange-700",children:"The following items are expiring within 7 days or have already expired:"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:B.map(t=>e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white px-2 py-1 text-xs font-medium text-orange-700 ring-1 ring-inset ring-orange-600/20",children:[t.name," (",new Date(t.expirationDate).toLocaleDateString(),")"]},t.id))})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-6 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("button",{onClick:()=>P("all"),className:`flex items-center justify-between p-5 bg-white rounded-xl border border-gray-100 shadow-sm transition-all hover:shadow-md cursor-pointer text-left group ${g==="all"?"ring-2 ring-primary-600 ring-offset-1":""}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 group-hover:text-primary-600 transition-colors",children:"Total Ingredients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.length})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-gray-100 text-gray-600 group-hover:bg-primary-50 group-hover:text-primary-600 transition-colors",children:e.jsx(Q,{className:"h-6 w-6"})})]}),e.jsxs("button",{onClick:()=>P("lowStock"),className:`flex items-center justify-between p-5 bg-white rounded-xl border border-gray-100 shadow-sm transition-all hover:shadow-md cursor-pointer text-left group ${g==="lowStock"?"ring-2 ring-yellow-500 ring-offset-1":""}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 group-hover:text-yellow-600 transition-colors",children:"Low Stock Items"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:V("All")})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-yellow-50 text-yellow-600 group-hover:bg-yellow-100 transition-colors",children:e.jsx(U,{className:"h-6 w-6"})})]}),e.jsxs("button",{onClick:()=>P("outOfStock"),className:`flex items-center justify-between p-5 bg-white rounded-xl border border-gray-100 shadow-sm transition-all hover:shadow-md cursor-pointer text-left group ${g==="outOfStock"?"ring-2 ring-red-500 ring-offset-1":""}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 group-hover:text-red-600 transition-colors",children:"Out of Stock"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.filter(t=>t.stock===0).length})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-red-50 text-red-600 group-hover:bg-red-100 transition-colors",children:e.jsx(E,{className:"h-6 w-6"})})]}),e.jsxs("button",{onClick:()=>P("newAdded"),className:`flex items-center justify-between p-5 bg-white rounded-xl border border-gray-100 shadow-sm transition-all hover:shadow-md cursor-pointer text-left group ${g==="newAdded"?"ring-2 ring-blue-500 ring-offset-1":""}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 group-hover:text-blue-600 transition-colors",children:"New Ingredients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:ae.length})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-blue-50 text-blue-600 group-hover:bg-blue-100 transition-colors",children:e.jsx(H,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search ingredients...",value:v,onChange:t=>M(t.target.value),className:"w-full rounded-lg border bg-white pl-10 pr-4 py-2.5 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500 focus:ring-opacity-20"})]})}),e.jsx("div",{className:"mb-6 overflow-x-auto py-1",children:e.jsx("div",{className:"flex gap-2 pb-2 px-1",children:oe.map(t=>{const s=re(t),o=V(t),d=l===t,c=se[t],n=c.icon;return e.jsxs("button",{onClick:()=>{T(t),q("all")},className:`flex-shrink-0 flex items-center gap-2 rounded-full px-4 py-2 text-sm font-semibold transition-all ${d?"bg-primary-600 text-white shadow-md scale-105":`${c.bgColor} ${c.color} hover:shadow-md hover:scale-102`}`,children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:t}),s>0&&e.jsx("span",{className:`inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full text-xs font-bold ${d?"bg-white bg-opacity-25":"bg-white bg-opacity-50"}`,children:s}),o>0&&e.jsxs("span",{className:"inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full text-xs font-bold bg-yellow-500 text-white",children:["âš  ",o]})]},t)})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:[z.map(t=>{const s=_(t);return e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex flex-col gap-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.category})]}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${s.color==="text-red-600"?"bg-red-50 text-red-700":s.color==="text-yellow-600"?"bg-yellow-50 text-yellow-700":"bg-green-50 text-green-700"}`,children:[e.jsx(s.Icon,{className:"h-3 w-3"}),s.text]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Current Stock"}),e.jsxs("p",{className:"font-medium text-gray-900",children:[t.stock.toLocaleString()," ",e.jsx("span",{className:"text-gray-400 text-xs",children:t.unit})]})]}),t.expirationDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Expires"}),e.jsx("p",{className:`font-medium ${new Date(t.expirationDate)<new Date?"text-red-600":"text-gray-900"}`,children:new Date(t.expirationDate).toLocaleDateString()})]}),e.jsx("button",{onClick:()=>O(t),className:"px-3 py-1.5 bg-primary-50 text-primary-700 text-xs font-semibold rounded-lg hover:bg-primary-100 transition-colors",children:"Update"})]})]},t.id)}),z.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No ingredients found."})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border bg-white shadow-sm",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Ingredient"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Current Stock"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Expiration"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Edit"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:z.map(t=>{const s=_(t);return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>O(t),children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[t.stock.toLocaleString()," ",e.jsx("span",{className:"text-gray-500",children:t.unit})]})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsx("div",{className:`text-sm ${t.expirationDate&&new Date(t.expirationDate)<new Date?"text-red-600 font-medium":"text-gray-900"}`,children:t.expirationDate?new Date(t.expirationDate).toLocaleDateString():"-"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1 text-sm font-semibold ${s.color}`,children:[e.jsx(s.Icon,{className:"h-4 w-4"}),s.text]})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:e.jsx("button",{onClick:o=>{o.stopPropagation(),O(t)},className:"text-primary-600 hover:text-primary-800",children:"Update Stock"})})]},t.id)})})]})}),k&&j&&e.jsx(Be,{ingredient:j,onClose:G,onUpdate:le}),e.jsx($e,{isOpen:S,onClose:R,onAdd:ie})]})};export{We as default};
