import{f as E,j as e,m as I,r as o,n as R,u as q,H as U,o as H,h as T,p as A,F as $,P as F}from"./index-BRbIdYOP.js";import{S as V}from"./star-CRQ68hbk.js";import{S as B}from"./sparkles-HgMMWhhJ.js";import{P as K}from"./ProductCardSkeleton-DSHtBTgd.js";import{S as O}from"./search-D8IsDpU3.js";import{A as Q}from"./arrow-up-down-D2lwxoST.js";const Z=({product:i,onAddToCart:N,onBuyNow:C,onProductClick:d,isLoggedIn:b})=>{const{name:c,category:S,imageUrl:x,comboImageUrl:y,available:p,stock:m,popular:g,new:v}=i,f=E(),h=i.sizes[0],k=h.name==="Combo Meal"&&y?y:x,r=!p||m===0,u=()=>{d?d(i,h):b?N(i,h):f("/auth/login")},w=n=>{!r&&(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),u())};return e.jsxs("div",{role:"button",tabIndex:r?-1:0,onClick:r?void 0:u,onKeyDown:w,className:`w-full text-left rounded-2xl overflow-hidden bg-white shadow-sm border transition-all ${r?"opacity-60 cursor-not-allowed":"cursor-pointer hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] border-gray-200 hover:border-primary-300"}`,children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("img",{src:k,alt:c,className:"w-full h-full object-cover"}),r&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm",children:"Out of Stock"})}),m>0&&m<5&&!r&&e.jsx("div",{className:"absolute top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded-lg text-xs font-bold",children:"Low Stock"}),g&&!r&&e.jsx("div",{className:"absolute top-2 left-2 rounded-full bg-amber-100 p-1.5 text-amber-600 shadow-sm",title:"Popular",children:e.jsx(V,{className:"h-4 w-4 fill-current"})}),v&&!r&&e.jsx("div",{className:"absolute top-10 left-2 rounded-full bg-blue-100 p-1.5 text-blue-600 shadow-sm",title:"New",children:e.jsx(B,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:S}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm md:text-base mb-2 line-clamp-1",children:c}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg md:text-xl font-bold text-primary-700",children:["₱",h.price.toFixed(2)]}),!r&&!b&&e.jsx("button",{onClick:n=>{n.stopPropagation(),f("/auth/login")},className:"text-xs md:text-sm font-bold text-primary-600 hover:text-primary-700 underline",children:"Login"})]})]})]})},_=[{value:"default",label:"Default"},{value:"price-asc",label:"Price: Low to High"},{value:"price-desc",label:"Price: High to Low"},{value:"name-asc",label:"Name: A-Z"},{value:"name-desc",label:"Name: Z-A"}],G={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},J={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},ae=()=>{const{products:i,isLoading:N,error:C}=I(),[d,b]=o.useState("All"),[c,S]=o.useState(""),[x,y]=o.useState("default"),[p,m]=o.useState(!1),g=o.useRef(null),v=o.useRef(null),{addToCart:f}=R(),{currentUser:h}=q(),[k,r]=o.useState(!1),[u,w]=o.useState(null),[n,P]=o.useState(null),L=(t,s)=>{["Coffee Based","Non Coffee","Refreshments","Matcha Series"].includes(t.category)?(w(t),P(s),r(!0)):f(t,s)},M=(t,s,a,l)=>{if(u&&(l||n)){const j=l||n;j&&f(u,j,t,s)}},D=o.useMemo(()=>i.length===0?["All"]:["All",...[...new Set(i.map(s=>s.category))].sort()],[i]);o.useEffect(()=>{const t=s=>{g.current&&!g.current.contains(s.target)&&m(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const z=o.useMemo(()=>{const s=[...i.filter(a=>{const l=d==="All"||a.category===d,j=c.trim()===""||a.name.toLowerCase().includes(c.toLowerCase())||a.description.toLowerCase().includes(c.toLowerCase());return l&&j})];switch(x){case"price-asc":s.sort((a,l)=>a.sizes[0].price-l.sizes[0].price);break;case"price-desc":s.sort((a,l)=>l.sizes[0].price-a.sizes[0].price);break;case"name-asc":s.sort((a,l)=>a.name.localeCompare(l.name));break;case"name-desc":s.sort((a,l)=>l.name.localeCompare(a.name));break}return s},[d,c,i,x]);return e.jsxs("div",{className:"flex min-h-screen flex-col bg-white",children:[e.jsx(U,{}),e.jsxs("main",{children:[e.jsxs("section",{className:"relative flex min-h-[40vh] items-center justify-center bg-primary-900 px-6 py-16 text-center text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=2574&auto=format&fit=crop')] bg-cover bg-center opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary-900/80 to-primary-900/90"}),e.jsxs("div",{className:"container relative z-40 mx-auto max-w-4xl animate-fade-in-up",children:[e.jsx("h1",{className:"font-display text-4xl font-bold md:text-5xl",children:"Our Menu"}),e.jsx("p",{className:"mt-2 text-lg text-gray-200",children:"Discover your perfect cup ☕"}),e.jsxs("div",{className:"mx-auto mt-8 flex max-w-2xl gap-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(O,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:t=>S(t.target.value),placeholder:"Search for coffee, matcha...",className:"w-full rounded-full border-0 bg-white/10 py-3 pl-12 pr-4 text-white placeholder:text-gray-400 ring-1 ring-white/20 transition focus:bg-white/20 focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"relative shrink-0",ref:g,children:[e.jsx("button",{onClick:()=>m(!p),className:"flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-white backdrop-blur-sm ring-1 ring-white/20 transition hover:bg-white/20","aria-haspopup":"true","aria-expanded":p,"aria-label":"Sort products",children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsx("div",{className:`absolute right-0 top-full z-[100] mt-2 w-56 origin-top-right rounded-xl border border-gray-100 bg-white p-1 shadow-xl ring-1 ring-black ring-opacity-5 transition-all duration-200 ease-out ${p?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu","aria-orientation":"vertical",children:e.jsx("div",{className:"py-1",role:"none",children:_.map(t=>e.jsxs("button",{onClick:()=>{y(t.value),m(!1)},className:`flex w-full items-center justify-between rounded-lg px-4 py-2.5 text-sm text-left font-medium transition-colors ${x===t.value?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,role:"menuitem",children:[e.jsx("span",{children:t.label}),x===t.value&&e.jsx(H,{className:"h-4 w-4"})]},t.value))})})]})]})]})]}),e.jsx("div",{className:"sticky top-16 z-20 border-b border-gray-200 bg-white/95 py-3 backdrop-blur-sm sm:top-20",children:e.jsx("div",{className:"container mx-auto flex max-w-7xl gap-2 overflow-x-auto px-6 pb-2",children:D.map(t=>e.jsx("button",{onClick:()=>{var s;b(t),(s=v.current)==null||s.scrollIntoView({behavior:"smooth"})},className:`flex-shrink-0 rounded-full px-4 py-2 text-sm font-semibold transition-colors ${d===t?"bg-primary-600 text-white shadow":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-100"}`,children:t},t))})}),e.jsx("section",{ref:v,className:"bg-gray-50 px-6 py-8 scroll-mt-36",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:N?e.jsx("div",{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:Array.from({length:8}).map((t,s)=>e.jsx(K,{},s))}):C?e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-red-200 bg-red-50 py-20 text-center text-red-700",children:[e.jsx(T,{className:"h-16 w-16"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"Oops! Something went wrong."}),e.jsx("p",{className:"mt-2",children:C})]}):z.length>0?e.jsx(A.div,{className:"grid grid-cols-2 gap-4 sm:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",variants:G,initial:"hidden",animate:"visible",children:z.map(t=>e.jsx(A.div,{variants:J,layout:!0,className:"flex",children:e.jsx(Z,{product:t,onAddToCart:L,onProductClick:(s,a)=>{w(s),P(a),r(!0)},isLoggedIn:!!h})},t.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(O,{className:"h-24 w-24 text-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"No products found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Try adjusting your filters or search query."})]})})})]}),e.jsx($,{}),u&&n&&e.jsx(F,{product:u,selectedSize:n,isOpen:k,onClose:()=>r(!1),onConfirm:M})]})};export{ae as default};
