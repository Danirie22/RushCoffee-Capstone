import{j as e,C as K,f as _,r as n,d as m,V as ee,S as se,A as Q,a6 as E,Y as I}from"./index-CeTvPb5i.js";import{S as te}from"./SalesOverview-DPTpLmVG.js";import{D as L,A as re}from"./dollar-sign-DAZX1ou4.js";import{C as R}from"./coffee-BfFzb84j.js";import{U as C}from"./users-DtFZ1pmi.js";import{C as ae}from"./chart-column-CawM1P5m.js";import{S as M}from"./star-BuyZ9k-S.js";import{P as U}from"./package-gtaLKwRw.js";import{Z as le}from"./zap-wcsBhCoZ.js";import{T as oe}from"./trending-up-2jcTlzGr.js";import"./clock-DRheYq4O.js";import"./calendar-BS-dkdsU.js";import"./arrow-up-down-DWI0BKhl.js";const ne={blue:{bg:"bg-blue-100",text:"text-blue-600"},green:{bg:"bg-green-100",text:"text-green-600"},yellow:{bg:"bg-yellow-100",text:"text-yellow-600"},purple:{bg:"bg-purple-100",text:"text-purple-600"},indigo:{bg:"bg-indigo-100",text:"text-indigo-600"},emerald:{bg:"bg-emerald-100",text:"text-emerald-600"},amber:{bg:"bg-amber-100",text:"text-amber-600"},orange:{bg:"bg-orange-100",text:"text-orange-600"},red:{bg:"bg-red-100",text:"text-red-600"}},h=({title:f,value:d,Icon:p,isLoading:g,color:w,trend:o,subtext:j})=>{const{bg:S,text:v}=ne[w];return e.jsxs(K,{className:"flex items-start justify-between p-5 border border-gray-100 shadow-sm transition-all hover:shadow-md h-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:f}),g?e.jsx("div",{className:"mt-1 h-8 w-24 animate-pulse rounded-md bg-gray-200"}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d}),j&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j})]}),!g&&o&&e.jsxs("div",{className:`flex items-center gap-1 text-xs font-medium ${o.value>=0?"text-green-600":"text-red-600"}`,children:[e.jsxs("span",{children:[o.value>0?"+":"",o.value,"%"]}),e.jsx("span",{className:"text-gray-400 font-normal",children:o.label})]})]}),e.jsx("div",{className:`flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-2xl ${S}`,children:e.jsx(p,{className:`h-6 w-6 ${v}`})})]})},Oe=()=>{const f=_(),[d,p]=n.useState({revenueToday:0,ordersToday:0,newCustomersToday:0,pendingOrders:0,totalCustomers:0,avgOrderValue:0}),[g,w]=n.useState({revenueYesterday:0,ordersYesterday:0,customersYesterday:0}),[o,j]=n.useState([]),[S,v]=n.useState(!0),[b,V]=n.useState([]),[z,k]=n.useState(!0),[y,F]=n.useState({totalCustomers:0,activeToday:0,averageLifetimeValue:0,topTierCustomers:0}),[u,q]=n.useState(!0),[P,$]=n.useState(new Date);n.useEffect(()=>{const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate()),A=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1),D=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),B=m.collection("orders").where("status","in",["waiting","preparing","ready"]).onSnapshot(t=>{const a=[];t.forEach(l=>{const r=l.data();a.push({id:l.id,...r,orderItems:r.orderItems||r.items||[],timestamp:r.timestamp.toDate()})}),a.sort((l,r)=>l.timestamp.getTime()-r.timestamp.getTime()),j(a),v(!1)},t=>{console.error("Error fetching queue:",t),v(!1)}),Z=m.collection("ingredients").onSnapshot(t=>{const a=[];t.forEach(l=>{const r=l.data();(r.stock===0||r.stock<=r.lowStockThreshold)&&a.push({id:l.id,name:r.name,stock:r.stock,unit:r.unit,lowStockThreshold:r.lowStockThreshold,category:r.category})}),V(a),k(!1)},t=>{console.error("Error fetching inventory:",t),k(!1)}),W=m.collection("orders").where("timestamp",">=",i).where("timestamp","<",A).onSnapshot(t=>{let a=0;const l=t.size;t.forEach(x=>{const c=x.data();c.status==="completed"&&(a+=c.totalAmount||0)});const r=l>0?a/l:0;p(x=>({...x,revenueToday:a,ordersToday:l,avgOrderValue:r}))},t=>console.error("Error fetching today's orders:",t)),X=m.collection("users").where("createdAt",">=",i).where("createdAt","<",A).onSnapshot(t=>{p(a=>({...a,newCustomersToday:t.size}))},t=>console.error("Error fetching new users:",t)),H=m.collection("orders").where("status","in",["waiting","preparing"]).onSnapshot(t=>{p(a=>({...a,pendingOrders:t.size}))},t=>console.error("Error fetching pending orders:",t)),J=m.collection("users").onSnapshot(t=>{let a=0,l=0,r=0;t.forEach(x=>{const c=x.data();a+=c.totalSpent||0,(c.tier==="gold"||c.tier==="silver")&&l++,c.lastOrderDate&&c.lastOrderDate.toDate()>=i&&r++}),F({totalCustomers:t.size,activeToday:r,averageLifetimeValue:t.size>0?a/t.size:0,topTierCustomers:l}),p(x=>({...x,totalCustomers:t.size}))},t=>console.error("Error fetching customer metrics:",t));return(async()=>{try{const t=await m.collection("orders").where("timestamp",">=",D).where("timestamp","<",i).get();let a=0;const l=t.size;t.forEach(c=>{const Y=c.data();Y.status==="completed"&&(a+=Y.totalAmount||0)});const x=(await m.collection("users").where("createdAt",">=",D).where("createdAt","<",i).get()).size;return{revenueYesterday:a,ordersYesterday:l,customersYesterday:x}}catch(t){return console.error("Error fetching yesterday's data:",t),{revenueYesterday:0,ordersYesterday:0,customersYesterday:0}}})().then(t=>{w(t),q(!1)}),()=>{B(),Z(),W(),X(),H(),J()}},[]);const N=(s,i)=>i===0?s>0?100:0:Number(((s-i)/i*100).toFixed(1)),G=()=>{$(new Date)},T=n.useMemo(()=>({waiting:o.filter(s=>s.status==="waiting").length,preparing:o.filter(s=>s.status==="preparing").length,ready:o.filter(s=>s.status==="ready").length}),[o]),O=n.useMemo(()=>({outOfStock:b.filter(s=>s.stock===0).length,lowStock:b.filter(s=>s.stock>0&&s.stock<=s.lowStockThreshold).length}),[b]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Real-time overview of your coffee shop operations"})]}),e.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium text-gray-700",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:["Last updated: ",P.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(h,{title:"Total Revenue Today",value:`₱${d.revenueToday.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Icon:L,isLoading:u,color:"blue",trend:{value:N(d.revenueToday,g.revenueYesterday),label:"vs yesterday"}}),e.jsx(h,{title:"Orders Today",value:d.ordersToday,Icon:R,isLoading:u,color:"green",trend:{value:N(d.ordersToday,g.ordersYesterday),label:"vs yesterday"}}),e.jsx(h,{title:"New Customers Today",value:d.newCustomersToday,Icon:C,isLoading:u,color:"yellow",trend:{value:N(d.newCustomersToday,g.customersYesterday),label:"vs yesterday"}}),e.jsx(h,{title:"Pending Orders",value:d.pendingOrders,Icon:ae,isLoading:u,color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsx(h,{title:"Avg Order Value",value:`₱${d.avgOrderValue.toFixed(2)}`,Icon:se,isLoading:u,color:"indigo",subtext:"Lifetime average"}),e.jsx(h,{title:"Total Customers",value:y.totalCustomers,Icon:C,isLoading:u,color:"emerald",subtext:"Registered users"}),e.jsx(h,{title:"Premium Members",value:y.topTierCustomers,Icon:M,isLoading:u,color:"amber",subtext:"Silver & Gold tiers"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Live Queue"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Real-time order management"})]})]}),e.jsxs("button",{onClick:()=>f("/admin/queue"),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:["Manage ",e.jsx(Q,{className:"h-4 w-4"})]})]})}),e.jsx("div",{className:"p-6",children:S?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary-600 border-t-transparent rounded-full"})}):o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No active orders in queue"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:T.waiting}),e.jsx("p",{className:"text-xs text-yellow-600 font-medium mt-1",children:"Waiting"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:T.preparing}),e.jsx("p",{className:"text-xs text-blue-600 font-medium mt-1",children:"Preparing"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-700",children:T.ready}),e.jsx("p",{className:"text-xs text-green-600 font-medium mt-1",children:"Ready"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-2",children:"Next in Queue"}),e.jsx("div",{className:"space-y-2",children:o.slice(0,3).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-primary-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:i+1}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.orderNumber}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.orderItems.length," item",s.orderItems.length>1?"s":""]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${s.status==="waiting"?"bg-yellow-100 text-yellow-700":s.status==="preparing"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]},s.id))})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Inventory Alerts"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Stock warnings & alerts"})]})]}),e.jsxs("button",{onClick:()=>f("/admin/inventory"),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-600 text-white text-sm font-semibold rounded-lg hover:bg-orange-700 transition-colors",children:["Manage ",e.jsx(Q,{className:"h-4 w-4"})]})]})}),e.jsx("div",{className:"p-6",children:z?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-orange-600 border-t-transparent rounded-full"})}):b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"h-12 w-12 text-green-300 mx-auto mb-3"}),e.jsx("p",{className:"text-green-600 text-sm font-medium",children:"All inventory levels are healthy!"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center border border-red-100",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(E,{className:"h-4 w-4 text-red-600"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:O.outOfStock})]}),e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Out of Stock"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 text-center border border-yellow-100",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(I,{className:"h-4 w-4 text-yellow-600"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:O.lowStock})]}),e.jsx("p",{className:"text-xs text-yellow-600 font-medium",children:"Low Stock"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-2",children:"Recent Alerts"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:b.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.stock===0?e.jsx(E,{className:"h-5 w-5 text-red-500 flex-shrink-0"}):e.jsx(I,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.category})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-bold ${s.stock===0?"text-red-600":"text-yellow-600"}`,children:[s.stock," ",s.unit]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Threshold: ",s.lowStockThreshold]})]})]},s.id))})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Customer Engagement"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Track customer behavior & loyalty"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"h-5 w-5 text-purple-600"}),e.jsx("p",{className:"text-sm font-semibold text-purple-900",children:"Active Today"})]}),e.jsx("p",{className:"text-3xl font-bold text-purple-700",children:y.activeToday}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"customers ordered today"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600"}),e.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Avg LTV"})]}),e.jsxs("p",{className:"text-3xl font-bold text-blue-700",children:["₱",y.averageLifetimeValue.toFixed(0)]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"lifetime customer value"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-4 border border-amber-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(M,{className:"h-5 w-5 text-amber-600"}),e.jsx("p",{className:"text-sm font-semibold text-amber-900",children:"Premium Tiers"})]}),e.jsx("p",{className:"text-3xl font-bold text-amber-700",children:y.topTierCustomers}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Silver & Gold members"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{className:"h-5 w-5 text-green-600"}),e.jsx("p",{className:"text-sm font-semibold text-green-900",children:"Growth Rate"})]}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:["+",N(d.newCustomersToday,g.customersYesterday).toFixed(0),"%"]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"vs yesterday"})]})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsx(te,{})})]})};export{Oe as default};
